{
    "version": "https://jsonfeed.org/version/1",
    "title": "千里稻花应秀色 • All posts by \"平台\" category",
    "description": "blogs by SSR",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2021/11/08/%E5%B9%B3%E5%8F%B0/Typora%E6%B7%BB%E5%8A%A0%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F/",
            "url": "http://example.com/2021/11/08/%E5%B9%B3%E5%8F%B0/Typora%E6%B7%BB%E5%8A%A0%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F/",
            "title": "Hexo添加数学公式",
            "date_published": "2021-11-08T07:02:54.000Z",
            "content_html": "<h2 id=\"在typora添加数学公式\"><a class=\"markdownIt-Anchor\" href=\"#在typora添加数学公式\"></a> 在Typora添加数学公式</h2>\n<p>Typora作为Markdown编辑器，在写技术文档时少不了输入各种Latex数学公式，下面介绍具体的设置、使用格式和常见的符号.</p>\n<p>1.进入<strong>文件-&gt;偏好设置-&gt;Markdown</strong>，将“Markdown扩展语法“全部勾选，然后重启Typora.</p>\n<p><a href=\"https://gitee.com/yixin-oss/blogImage/raw/master/img/1624945882(1).jpg\"><img src=\"1624945882(1).jpg\" class=\"lazyload placeholder\" data-srcset=\"1624945882(1).jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"img\"></a></p>\n<p>2.使用格式</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">行间式</th>\n<th style=\"text-align:center\">行外式</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">文字间插入公式，只需公式前后加上$</td>\n<td style=\"text-align:center\">公式单独一行居中显示.右键插入公式块或换行输入$$再回车或快捷键<strong>ctrl+shift+M</strong></td>\n</tr>\n</tbody>\n</table>\n<p>效果预览：</p>\n<p><a href=\"https://gitee.com/yixin-oss/blogImage/raw/master/img/1624945949(1).jpg\"><img src=\"1624945949(1).jpg\" class=\"lazyload placeholder\" data-srcset=\"1624945949(1).jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"img\"></a></p>\n<p><a href=\"https://gitee.com/yixin-oss/blogImage/raw/master/img/1624946022(1).jpg\"><img src=\"1624946022(1).jpg\" class=\"lazyload placeholder\" data-srcset=\"1624946022(1).jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"img\"></a></p>\n<p>3.常用符号及规则</p>\n<ul>\n<li>上下标、矢量、分式、根号、累加累乘</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">数学表达式</th>\n<th style=\"text-align:center\">Latex代码</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">x2</td>\n<td style=\"text-align:center\">x^2</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">x1</td>\n<td style=\"text-align:center\">x_1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">F→</td>\n<td style=\"text-align:center\">\\vec F</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">12</td>\n<td style=\"text-align:center\">\\frac{1}{2}</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">\\sqrt{2}</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">∑i=1nai</td>\n<td style=\"text-align:center\">\\sum_{i=1}^{n}a_{i}</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">∏i=1nai</td>\n<td style=\"text-align:center\">\\prod_{i=1}^{n}a_{i}</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>极限、无穷</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">数学表达式</th>\n<th style=\"text-align:center\">Latex代码</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">lima→+∞</td>\n<td style=\"text-align:center\">\\lim_{a\\rightarrow+\\infty}</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">∞</td>\n<td style=\"text-align:center\">\\infty</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>关系运算符</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">数学表达式</th>\n<th style=\"text-align:center\">Latex代码</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">≤</td>\n<td style=\"text-align:center\">\\leq</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">≠</td>\n<td style=\"text-align:center\">\\neq</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">≥</td>\n<td style=\"text-align:center\">\\geq</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>希腊字母</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">数学表达式</th>\n<th style=\"text-align:center\">Latex代码</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">α</td>\n<td style=\"text-align:center\">\\alpha</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">β</td>\n<td style=\"text-align:center\">\\beta</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">γ</td>\n<td style=\"text-align:center\">\\gamma</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">δ</td>\n<td style=\"text-align:center\">\\delta</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ε</td>\n<td style=\"text-align:center\">\\varepsilon</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">λ</td>\n<td style=\"text-align:center\">\\lambda</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ϕ</td>\n<td style=\"text-align:center\">\\phi</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ξ</td>\n<td style=\"text-align:center\">\\xi</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ψ</td>\n<td style=\"text-align:center\">\\psi</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ω</td>\n<td style=\"text-align:center\">\\omega</td>\n</tr>\n</tbody>\n</table>\n<p>快速获取更多希腊字母的Latex代码可以进入<a href=\"http://detexify.kirelabs.org/classify.html\">手写识别网站</a></p>\n<h2 id=\"在hexo中渲染mathjax数学公式\"><a class=\"markdownIt-Anchor\" href=\"#在hexo中渲染mathjax数学公式\"></a> 在Hexo中渲染MathJax数学公式</h2>\n<p>由于Hexo默认使用“hexo-renderer-marked”引擎渲染网页，使得一些特殊的markdown符号和html标签存在语义冲突，如下划线‘‘_’‘在Latex公式中表示下标，而在html中引擎会将其处理为<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>∗</mo></mrow><annotation encoding=\"application/x-tex\">*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.46528em;vertical-align:0em;\"></span><span class=\"mord\">∗</span></span></span></span>标签，导致数学公式在博客文章中出现各种错误.*</p>\n<h3 id=\"处理方法\"><a class=\"markdownIt-Anchor\" href=\"#处理方法\"></a> 处理方法</h3>\n<h4 id=\"更换渲染引擎\"><a class=\"markdownIt-Anchor\" href=\"#更换渲染引擎\"></a> 更换渲染引擎</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm uninstall hexo-renderer-marked --save #卸载原引擎</span><br><span class=\"line\">npm install hexo-renderer-kramed --save #安装新引擎</span><br><span class=\"line\">npm install hexo-filter-mathjax --save</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>在安装新引擎时，还可能会出现由于超时导致安装失败的问题，可以先把npm换到淘宝镜像，再安装新引擎.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config set registry https://registry.npm.taobao.org #永久使用（推荐）</span><br></pre></td></tr></table></figure>\n<h4 id=\"变量修改\"><a class=\"markdownIt-Anchor\" href=\"#变量修改\"></a> 变量修改</h4>\n<p>到博客根目录下，找到node_modules\\kramed\\lib\\rules\\inline.js，把espace和em变量的值做相应修改.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">escape: /^\\\\([`*\\[\\]()#$+\\-.!_&gt;])/</span><br><span class=\"line\">em: /^\\*((?:\\*\\*|[\\s\\S])+?)\\*(?!\\*)/</span><br></pre></td></tr></table></figure>\n<h4 id=\"开启mathjax\"><a class=\"markdownIt-Anchor\" href=\"#开启mathjax\"></a> 开启mathjax</h4>\n<p>进入到主题目录，找到**_config.yml**，把mathjax默认的false修改为true，具体如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Math Formulas Render Support</span><br><span class=\"line\">math:</span><br><span class=\"line\">  # Default (true) will load mathjax / katex script on demand.</span><br><span class=\"line\">  # That is it only render those page which has `mathjax: true` in Front-matter.</span><br><span class=\"line\">  # If you set it to false, it will load mathjax / katex srcipt EVERY PAGE.</span><br><span class=\"line\">  per_page: true</span><br><span class=\"line\"></span><br><span class=\"line\">  # hexo-renderer-pandoc (or hexo-renderer-kramed) required for full MathJax support.</span><br><span class=\"line\">  mathjax:</span><br><span class=\"line\">    enable: true</span><br><span class=\"line\">    # See: https://mhchem.github.io/MathJax-mhchem/</span><br><span class=\"line\">    mhchem: false</span><br></pre></td></tr></table></figure>\n<h4 id=\"文章设置\"><a class=\"markdownIt-Anchor\" href=\"#文章设置\"></a> 文章设置</h4>\n<p>在文章的Front-matter中打开mathjax开关(开篇手动输入‘—-‘即可出现该模块)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: Hexo使用数学公式</span><br><span class=\"line\">tags: hexo</span><br><span class=\"line\">categories: hexo博客搭建</span><br><span class=\"line\">mathjax: true </span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n<p>这样设置的好处是只在用到数学公式的页面才加载 Mathjax，不需要渲染数学公式的页面的访问速度则不会受到影响.</p>\n",
            "tags": [
                "Hexo"
            ]
        },
        {
            "id": "http://example.com/2021/09/28/%E5%B9%B3%E5%8F%B0/Ambari/",
            "url": "http://example.com/2021/09/28/%E5%B9%B3%E5%8F%B0/Ambari/",
            "title": "Ambari",
            "date_published": "2021-09-28T10:39:27.000Z",
            "content_html": "<h1 id=\"ambari\"><a class=\"markdownIt-Anchor\" href=\"#ambari\"></a> Ambari</h1>\n<h2 id=\"1什么是ambari\"><a class=\"markdownIt-Anchor\" href=\"#1什么是ambari\"></a> 1.什么是Ambari</h2>\n<p>Apache Ambari项目旨在通过开发用于配置，管理和监视Apache Hadoop集群的软件来简化Hadoop管理。Ambari通过其RESTful API提供了直观，易于使用的Hadoop管理Web UI。</p>\n<p>Ambari使系统管理员可以：</p>\n<ul>\n<li>\n<p>设置Hadoop集群</p>\n<ul>\n<li>Ambari提供了用于在任意数量的主机上安装Hadoop服务的分步向导。</li>\n<li>Ambari处理群集的Hadoop服务的配置。</li>\n</ul>\n</li>\n<li>\n<p>管理Hadoop集群</p>\n<ul>\n<li>Ambari提供了用于在整个集群中启动，停止和重新配置Hadoop服务的集中管理。</li>\n</ul>\n</li>\n<li>\n<p>监控Hadoop集群</p>\n<ul>\n<li>Ambari提供了一个仪表板，用于监视Hadoop集群的运行状况和状态。</li>\n<li>Ambari利用<a href=\"https://issues.apache.org/jira/browse/AMBARI-5707\">Ambari Metrics System</a>收集指标。</li>\n<li>Ambari利用<a href=\"https://issues.apache.org/jira/browse/AMBARI-6354\">Ambari Alert Framework</a>进行系统警报，并在需要您关注时（例如，节点故障，剩余磁盘空间不足等）通知您。</li>\n</ul>\n</li>\n</ul>\n<p>Ambari使应用程序开发人员和系统集成商能够：</p>\n<ul>\n<li>使用<a href=\"https://github.com/apache/blob/trunk/ambari-server/docs/api/v1/index.md\">Ambari REST API</a>轻松将Hadoop的配置，管理和监视功能集成到自己的应用<a href=\"https://github.com/apache/blob/trunk/ambari-server/docs/api/v1/index.md\">程序中</a>。</li>\n</ul>\n<p>官方网站：<a href=\"http://ambari.apache.org/\">http://ambari.apache.org/</a></p>\n<h2 id=\"2ambari架构\"><a class=\"markdownIt-Anchor\" href=\"#2ambari架构\"></a> 2.Ambari架构</h2>\n<p><img src=\"20201010140739738.png\" class=\"lazyload placeholder\" data-srcset=\"20201010140739738.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"\" /></p>\n<h3 id=\"ambari-server\"><a class=\"markdownIt-Anchor\" href=\"#ambari-server\"></a> ambari-server</h3>\n<ul>\n<li>提供外部访问的API</li>\n<li>接受Ambari-agent的心跳信息和管理Ambari-agent</li>\n<li>元数据的管理和数据库的访问</li>\n</ul>\n<h3 id=\"ambari-agent\"><a class=\"markdownIt-Anchor\" href=\"#ambari-agent\"></a> ambari-agent</h3>\n<ul>\n<li>采集所在节点的信息并且汇总发心跳汇报给ambari-server</li>\n<li>处理ambari-server的执行请求,安装、启动、停止服务等</li>\n</ul>\n<h3 id=\"ambari-web\"><a class=\"markdownIt-Anchor\" href=\"#ambari-web\"></a> ambari-web</h3>\n<ul>\n<li>提供可视化的操作界面</li>\n</ul>\n<h2 id=\"3下载\"><a class=\"markdownIt-Anchor\" href=\"#3下载\"></a> 3.下载</h2>\n<p>Ambari所在的公司已经被Cloudera公司收购所以相关的文档都在clodera公司的官方网站：<a href=\"https://docs.cloudera.com/HDPDocuments/index.html\">https://docs.cloudera.com/HDPDocuments/index.html</a></p>\n<p>我们选择的安装方式是:Ambari+HDP+HDP-UTILS,因为Ambari本身只是一个大数据平台自动化部署和管理的工具，所以需要配合HDP(大数据软件安装包集合)一起使用。</p>\n<p><img src=\"image-20211009131251511.png\" class=\"lazyload placeholder\" data-srcset=\"image-20211009131251511.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20211009131251511\" /></p>\n<p>选择合适的版本，我们这里选择的是2.7.0.0版本，然后就会有一个安装指南：<a href=\"https://docs.cloudera.com/HDPDocuments/Ambari-2.7.0.0/bk_ambari-installation/content/ambari_repositories.html\">https://docs.cloudera.com/HDPDocuments/Ambari-2.7.0.0/bk_ambari-installation/content/ambari_repositories.html</a></p>\n<p>其实可以直接配置官网提供的yum源就可以安装，但是由于是国外的网站，速度比较慢，所以就使用离线本地yum源的安装方式</p>\n<h2 id=\"4安装环境说明\"><a class=\"markdownIt-Anchor\" href=\"#4安装环境说明\"></a> 4.安装环境说明</h2>\n<p>使用VMWare/VirtualBox，虚拟四台虚拟机，(也可以将server配置在一台节点中)其中ambari是服务器，其他为HDP安装节点，配置如下:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">主机</th>\n<th style=\"text-align:center\">系统</th>\n<th style=\"text-align:center\"><strong>网络</strong></th>\n<th style=\"text-align:center\">内存</th>\n<th>磁盘</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">ambari</td>\n<td style=\"text-align:center\">CentOS7</td>\n<td style=\"text-align:center\">172.18.74.160(NAT/birdge)</td>\n<td style=\"text-align:center\">4G</td>\n<td>50G</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">hdp-1</td>\n<td style=\"text-align:center\">CentOS7</td>\n<td style=\"text-align:center\">172.18.74.161(NAT/birdge)</td>\n<td style=\"text-align:center\">4G</td>\n<td>50G</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">hdp-2</td>\n<td style=\"text-align:center\">CentOS7</td>\n<td style=\"text-align:center\">172.18.74.162(NAT/birdge)</td>\n<td style=\"text-align:center\">4G</td>\n<td>50G</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">hdp-3</td>\n<td style=\"text-align:center\">CentOS7</td>\n<td style=\"text-align:center\">172.18.74.163(NAT/birdge)</td>\n<td style=\"text-align:center\">4G</td>\n<td>50G</td>\n</tr>\n</tbody>\n</table>\n<p>配置好虚拟机就可以安装了,安装的方式如下</p>\n<p><img src=\"20201010141026410.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141026410.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<h2 id=\"5server端环境配置ambari\"><a class=\"markdownIt-Anchor\" href=\"#5server端环境配置ambari\"></a> 5.Server端环境配置(ambari)</h2>\n<p>说明：如果服务器已经配置好，则直接进行第6节客户端的配置。</p>\n<h3 id=\"51安装http服务\"><a class=\"markdownIt-Anchor\" href=\"#51安装http服务\"></a> 5.1.安装http服务</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install -y httpd</span><br><span class=\"line\">systemctl start httpd</span><br><span class=\"line\">systemctl enable httpd</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"52配置yum源\"><a class=\"markdownIt-Anchor\" href=\"#52配置yum源\"></a> 5.2.配置yum源</h3>\n<p>虚拟机的网络模式是nat或者桥接的时候就可以连通外网，这样我们就可以不用配置CentOS的yum源了，但是Ambari和HDP的还需要我们配置，需要将Ambari和HDP以及HDP-UTILS的安装包通过SFTP工具上传到ambari上。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">创建文件夹</span></span><br><span class=\"line\">mkdir /var/www/html/&#123;ambari,hdp,hdp-utils&#125;</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 解压安装包到HTTP的网页根目录</span></span><br><span class=\"line\">tar -zxvf HDP-UTILS-1.1.0.22-centos7.tar.gz -C /var/www/html/hdp-utils/</span><br><span class=\"line\">tar -zxvf ambari-2.7.0.0-centos7.tar.gz -C /var/www/html/</span><br><span class=\"line\">tar -zxvf HDP-3.0.0.0-centos7-rpm.tar.gz -C /var/www/html/hdp</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>这样就可以通过http的方式获取到相应的rpm文件和repodata文件来配置yum源了</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置ambari的yum源</span></span><br><span class=\"line\">vi /etc/yum.repos.d/ambari.repo</span><br><span class=\"line\">[ambari]</span><br><span class=\"line\">name=ambari</span><br><span class=\"line\">baseurl=http://172.18.74.160/centos7/2.7.0.0-897/</span><br><span class=\"line\">gpgcheck=0</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">配置hdp和hdp-utils的yum源</span></span><br><span class=\"line\">vi /etc/yum.repos.d/hdp.repo</span><br><span class=\"line\">[HDP]</span><br><span class=\"line\">name=HDP</span><br><span class=\"line\">baseurl=http://172.18.74.160/hdp/HDP/centos7/3.0.0.0-1634/</span><br><span class=\"line\">gpgcheck=0</span><br><span class=\"line\">[HDP-UTILS]</span><br><span class=\"line\">name=HDP_UTILS</span><br><span class=\"line\">baseurl=http://172.18.74.160/hdp-utils/HDP-UTILS/centos7/1.1.0.22/</span><br><span class=\"line\">gpgcheck=0</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 验证</span></span><br><span class=\"line\">yum repolist</span><br></pre></td></tr></table></figure>\n<p>将yum文件使用scp发送到客户端节点</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp /etc/yum.repos.d/ambari.repo hdp-1:/etc/yum.repos.d/</span><br><span class=\"line\">scp /etc/yum.repos.d/hdp.repo hdp-1:/etc/yum.repos.d/</span><br></pre></td></tr></table></figure>\n<h3 id=\"53数据库配置\"><a class=\"markdownIt-Anchor\" href=\"#53数据库配置\"></a> 5.3.数据库配置</h3>\n<p>数据库使用MariaDB作为元数据储存的库，存放ambari服务数据</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 安装</span></span><br><span class=\"line\">yum install -y mariadb-server</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 启动 开机自启</span></span><br><span class=\"line\">systemctl start mariadb &amp;&amp; systemctl enable mariadb</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 初始化</span></span><br><span class=\"line\">mysql_secure_installation</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">[root@ambari</span> <span class=\"string\">~]# mysql_secure_installation </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">NOTE</span>: <span class=\"string\">RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB</span></span><br><span class=\"line\">      <span class=\"attr\">SERVERS</span> <span class=\"string\">IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">In</span> <span class=\"string\">order to log into MariaDB to secure it, we&#x27;ll need the current</span></span><br><span class=\"line\"><span class=\"attr\">password</span> <span class=\"string\">for the root user.  If you&#x27;ve just installed MariaDB, and</span></span><br><span class=\"line\"><span class=\"attr\">you</span> <span class=\"string\">haven&#x27;t set the root password yet, the password will be blank,</span></span><br><span class=\"line\"><span class=\"attr\">so</span> <span class=\"string\">you should just press enter here.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Enter</span> <span class=\"string\">current password for root (enter for none): </span></span><br><span class=\"line\"><span class=\"meta\">OK,</span> <span class=\"string\">successfully used password, moving on...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Setting</span> <span class=\"string\">the root password ensures that nobody can log into the MariaDB</span></span><br><span class=\"line\"><span class=\"attr\">root</span> <span class=\"string\">user without the proper authorisation.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Set</span> <span class=\"string\">root password? [Y/n] </span></span><br><span class=\"line\"><span class=\"attr\">New</span> <span class=\"string\">password: </span></span><br><span class=\"line\"><span class=\"meta\">Re-enter</span> <span class=\"string\">new password: </span></span><br><span class=\"line\"><span class=\"attr\">Password</span> <span class=\"string\">updated successfully!</span></span><br><span class=\"line\"><span class=\"attr\">Reloading</span> <span class=\"string\">privilege tables..</span></span><br><span class=\"line\"> <span class=\"meta\">...</span> <span class=\"string\">Success!</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">By</span> <span class=\"string\">default, a MariaDB installation has an anonymous user, allowing anyone</span></span><br><span class=\"line\"><span class=\"attr\">to</span> <span class=\"string\">log into MariaDB without having to have a user account created for</span></span><br><span class=\"line\"><span class=\"meta\">them.</span>  <span class=\"string\">This is intended only for testing, and to make the installation</span></span><br><span class=\"line\"><span class=\"attr\">go</span> <span class=\"string\">a bit smoother.  You should remove them before moving into a</span></span><br><span class=\"line\"><span class=\"attr\">production</span> <span class=\"string\">environment.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Remove</span> <span class=\"string\">anonymous users? [Y/n] </span></span><br><span class=\"line\"> <span class=\"meta\">...</span> <span class=\"string\">Success!</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">Normally,</span> <span class=\"string\">root should only be allowed to connect from &#x27;localhost&#x27;.  This</span></span><br><span class=\"line\"><span class=\"attr\">ensures</span> <span class=\"string\">that someone cannot guess at the root password from the network.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Disallow</span> <span class=\"string\">root login remotely? [Y/n] n</span></span><br><span class=\"line\"> <span class=\"meta\">...</span> <span class=\"string\">skipping.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">By</span> <span class=\"string\">default, MariaDB comes with a database named &#x27;test&#x27; that anyone can</span></span><br><span class=\"line\"><span class=\"meta\">access.</span>  <span class=\"string\">This is also intended only for testing, and should be removed</span></span><br><span class=\"line\"><span class=\"attr\">before</span> <span class=\"string\">moving into a production environment.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Remove</span> <span class=\"string\">test database and access to it? [Y/n] </span></span><br><span class=\"line\"> <span class=\"meta\">-</span> <span class=\"string\">Dropping test database...</span></span><br><span class=\"line\"> <span class=\"meta\">...</span> <span class=\"string\">Success!</span></span><br><span class=\"line\"> <span class=\"meta\">-</span> <span class=\"string\">Removing privileges on test database...</span></span><br><span class=\"line\"> <span class=\"meta\">...</span> <span class=\"string\">Success!</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Reloading</span> <span class=\"string\">the privilege tables will ensure that all changes made so far</span></span><br><span class=\"line\"><span class=\"attr\">will</span> <span class=\"string\">take effect immediately.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Reload</span> <span class=\"string\">privilege tables now? [Y/n] </span></span><br><span class=\"line\"> <span class=\"meta\">...</span> <span class=\"string\">Success!</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Cleaning</span> <span class=\"string\">up...</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">All</span> <span class=\"string\">done!  If you&#x27;ve completed all of the above steps, your MariaDB</span></span><br><span class=\"line\"><span class=\"attr\">installation</span> <span class=\"string\">should now be secure.</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">Thanks</span> <span class=\"string\">for using MariaDB!</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"531创建数据库\"><a class=\"markdownIt-Anchor\" href=\"#531创建数据库\"></a> 5.3.1.创建数据库</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -uroot -p</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 创建amabri数据库</span></span><br><span class=\"line\">create database ambari;</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">授权</span></span><br><span class=\"line\">grant all on ambari.* to ambari@&#x27;%&#x27; identified by &#x27;bigdata&#x27;;</span><br><span class=\"line\">grant all on ambari.* to ambari@localhost identified by &#x27;bigdata&#x27;;</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 使用ambari-server提供的sql脚本创建相关的表</span></span><br><span class=\"line\">use ambari;</span><br><span class=\"line\">source /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql</span><br></pre></td></tr></table></figure>\n<h4 id=\"532将jdbc驱动包复制到指定目录usrsharejava\"><a class=\"markdownIt-Anchor\" href=\"#532将jdbc驱动包复制到指定目录usrsharejava\"></a> 5.3.2.将JDBC驱动包复制到指定目录（/usr/share/java）</h4>\n<p>将jdbc的驱动包使用sftp工具上传到ambari</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv mysql-connector-java-*.jar /usr/share/java/mysql-connector-java.jar</span><br><span class=\"line\">ambari-server setup --jdbc-db=mysql --jdbc-driver=/usr/share/java/mysql-connector-java.jar</span><br></pre></td></tr></table></figure>\n<h3 id=\"54安装ambari-server\"><a class=\"markdownIt-Anchor\" href=\"#54安装ambari-server\"></a> 5.4.安装ambari-server</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 安装</span></span><br><span class=\"line\">yum install -y ambari-server</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置ambari-server</span></span><br><span class=\"line\">ambari-server setup</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">[root@hdp-1</span> <span class=\"string\">~]# ambari-server setup</span></span><br><span class=\"line\"><span class=\"attr\">Using</span> <span class=\"string\">python  /usr/bin/python</span></span><br><span class=\"line\"><span class=\"attr\">Setup</span> <span class=\"string\">ambari-server</span></span><br><span class=\"line\"><span class=\"attr\">Checking</span> <span class=\"string\">SELinux...</span></span><br><span class=\"line\"><span class=\"attr\">SELinux</span> <span class=\"string\">status is &#x27;enabled&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">SELinux</span> <span class=\"string\">mode is &#x27;permissive&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">WARNING</span>: <span class=\"string\">SELinux is set to &#x27;permissive&#x27; mode and temporarily disabled.</span></span><br><span class=\"line\"><span class=\"attr\">OK</span> <span class=\"string\">to continue [y/n] (y)? y</span></span><br><span class=\"line\"><span class=\"attr\">Customize</span> <span class=\"string\">user account for ambari-server daemon [y/n] (n)? y</span></span><br><span class=\"line\"><span class=\"attr\">Enter</span> <span class=\"string\">user account for ambari-server daemon (root):</span></span><br><span class=\"line\"><span class=\"attr\">Adjusting</span> <span class=\"string\">ambari-server permissions and ownership...</span></span><br><span class=\"line\"><span class=\"attr\">Checking</span> <span class=\"string\">firewall status...</span></span><br><span class=\"line\"><span class=\"attr\">Checking</span> <span class=\"string\">JDK...</span></span><br><span class=\"line\"><span class=\"meta\">[1]</span> <span class=\"string\">Oracle JDK 1.8 + Java Cryptography Extension (JCE) Policy Files 8</span></span><br><span class=\"line\"><span class=\"meta\">[2]</span> <span class=\"string\">Custom JDK</span></span><br><span class=\"line\">==============================================================================</span><br><span class=\"line\"><span class=\"attr\">Enter</span> <span class=\"string\">choice (1): 2</span></span><br><span class=\"line\"><span class=\"attr\">WARNING</span>: <span class=\"string\">JDK must be installed on all hosts and JAVA_HOME must be valid on all hosts.</span></span><br><span class=\"line\"><span class=\"attr\">WARNING</span>: <span class=\"string\">JCE Policy files are required for configuring Kerberos security. If you plan to use Kerberos,please make sure JCE Unlimited Strength Jurisdiction Policy Files are valid on all hosts.</span></span><br><span class=\"line\"><span class=\"attr\">Path</span> <span class=\"string\">to JAVA_HOME: /opt/jdk1.8.0_171/</span></span><br><span class=\"line\"><span class=\"attr\">Validating</span> <span class=\"string\">JDK on Ambari Server...done.</span></span><br><span class=\"line\"><span class=\"attr\">Check</span> <span class=\"string\">JDK version for Ambari Server...</span></span><br><span class=\"line\"><span class=\"attr\">JDK</span> <span class=\"string\">version found: 8</span></span><br><span class=\"line\"><span class=\"attr\">Minimum</span> <span class=\"string\">JDK version is 8 for Ambari. Skipping to setup different JDK for Ambari Server.</span></span><br><span class=\"line\"><span class=\"attr\">Checking</span> <span class=\"string\">GPL software agreement...</span></span><br><span class=\"line\"><span class=\"attr\">GPL</span> <span class=\"string\">License for LZO: https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html</span></span><br><span class=\"line\"><span class=\"attr\">Enable</span> <span class=\"string\">Ambari Server to download and install GPL Licensed LZO packages [y/n] (n)? </span></span><br><span class=\"line\"><span class=\"attr\">Completing</span> <span class=\"string\">setup...</span></span><br><span class=\"line\"><span class=\"attr\">Configuring</span> <span class=\"string\">database...</span></span><br><span class=\"line\"><span class=\"attr\">Enter</span> <span class=\"string\">advanced database configuration [y/n] (n)? y</span></span><br><span class=\"line\"><span class=\"attr\">Configuring</span> <span class=\"string\">database...</span></span><br><span class=\"line\">==============================================================================</span><br><span class=\"line\"><span class=\"attr\">Choose</span> <span class=\"string\">one of the following options:</span></span><br><span class=\"line\"><span class=\"meta\">[1]</span> <span class=\"string\">- PostgreSQL (Embedded)</span></span><br><span class=\"line\"><span class=\"meta\">[2]</span> <span class=\"string\">- Oracle</span></span><br><span class=\"line\"><span class=\"meta\">[3]</span> <span class=\"string\">- MySQL / MariaDB</span></span><br><span class=\"line\"><span class=\"meta\">[4]</span> <span class=\"string\">- PostgreSQL</span></span><br><span class=\"line\"><span class=\"meta\">[5]</span> <span class=\"string\">- Microsoft SQL Server (Tech Preview)</span></span><br><span class=\"line\"><span class=\"meta\">[6]</span> <span class=\"string\">- SQL Anywhere</span></span><br><span class=\"line\"><span class=\"meta\">[7]</span> <span class=\"string\">- BDB</span></span><br><span class=\"line\">==============================================================================</span><br><span class=\"line\"><span class=\"attr\">Enter</span> <span class=\"string\">choice (1): 3</span></span><br><span class=\"line\"><span class=\"attr\">Hostname</span> <span class=\"string\">(localhost): </span></span><br><span class=\"line\"><span class=\"attr\">Port</span> <span class=\"string\">(3306): </span></span><br><span class=\"line\"><span class=\"attr\">Database</span> <span class=\"string\">name (ambari): </span></span><br><span class=\"line\"><span class=\"attr\">Username</span> <span class=\"string\">(ambari): </span></span><br><span class=\"line\"><span class=\"attr\">Enter</span> <span class=\"string\">Database Password (bigdata): </span></span><br><span class=\"line\"><span class=\"attr\">Configuring</span> <span class=\"string\">ambari database...</span></span><br><span class=\"line\"><span class=\"attr\">Should</span> <span class=\"string\">ambari use existing default jdbc /usr/share/java/mysql-connector-java.jar [y/n] (y)? </span></span><br><span class=\"line\"><span class=\"attr\">Configuring</span> <span class=\"string\">remote database connection properties...</span></span><br><span class=\"line\"><span class=\"attr\">WARNING</span>: <span class=\"string\">Before starting Ambari Server, you must run the following DDL against the database to create the schema: /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql</span></span><br><span class=\"line\"><span class=\"attr\">Proceed</span> <span class=\"string\">with configuring remote database connection properties [y/n] (y)? </span></span><br><span class=\"line\"><span class=\"attr\">Extracting</span> <span class=\"string\">system views...</span></span><br><span class=\"line\"><span class=\"attr\">ambari-admin-2.7.0.0.897.jar</span></span><br><span class=\"line\"><span class=\"attr\">....</span></span><br><span class=\"line\"><span class=\"attr\">Ambari</span> <span class=\"string\">repo file doesn&#x27;t contain latest json url, skipping repoinfos modification</span></span><br><span class=\"line\"><span class=\"attr\">Adjusting</span> <span class=\"string\">ambari-server permissions and ownership...</span></span><br><span class=\"line\"><span class=\"attr\">Ambari</span> <span class=\"string\">Server &#x27;setup&#x27; completed successfully.</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"55启动ambari-server\"><a class=\"markdownIt-Anchor\" href=\"#55启动ambari-server\"></a> 5.5启动ambari-server</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ambari-server start</span><br></pre></td></tr></table></figure>\n<p>可以访问ambari的web界面: <a href=\"http://172.18.74.160:8080\">http://172.18.74.160:8080</a></p>\n<h2 id=\"6client端环境配置\"><a class=\"markdownIt-Anchor\" href=\"#6client端环境配置\"></a> 6.Client端环境配置</h2>\n<p>说明：以下配置是在需要安装集群的各个节点中进行，此处为hdp-1,hdp-2,hdp-3。</p>\n<h3 id=\"61修改主机名和配置主机到ip的映射所有节点\"><a class=\"markdownIt-Anchor\" href=\"#61修改主机名和配置主机到ip的映射所有节点\"></a> 6.1修改主机名和配置主机到IP的映射(所有节点)</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 分别修改三台机器的主机名</span></span><br><span class=\"line\">hostnamectl set-hostname hdp-1</span><br><span class=\"line\">hostnamectl set-hostname hdp-2</span><br><span class=\"line\">hostnamectl set-hostname hdp-3</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">立即生效</span></span><br><span class=\"line\">bash</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置主机名到IP的映射</span></span><br><span class=\"line\">vi /etc/hosts</span><br><span class=\"line\">172.18.74.160 ambari</span><br><span class=\"line\">172.18.74.161 hdp-1</span><br><span class=\"line\">172.18.74.162 hdp-2</span><br><span class=\"line\">172.18.74.163 hdp-3</span><br></pre></td></tr></table></figure>\n<h3 id=\"62关闭防火墙和关闭selinux所有节点\"><a class=\"markdownIt-Anchor\" href=\"#62关闭防火墙和关闭selinux所有节点\"></a> 6.2关闭防火墙和关闭SELinux(所有节点)</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 关闭防火墙</span></span><br><span class=\"line\">systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 关闭selinux</span></span><br><span class=\"line\">setenforce 0</span><br><span class=\"line\">vi /etc/selinux/config</span><br><span class=\"line\">SELINUX=disabled</span><br></pre></td></tr></table></figure>\n<h3 id=\"63配置免密登录所有节点\"><a class=\"markdownIt-Anchor\" href=\"#63配置免密登录所有节点\"></a> 6.3.配置免密登录(所有节点)</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> hpd-1</span></span><br><span class=\"line\">ssh-keygen</span><br><span class=\"line\">ssh-copy-id hdp-1</span><br><span class=\"line\">ssh-copy-id hdp-2</span><br><span class=\"line\">ssh-copy-id hdp-3</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> hdp-2</span></span><br><span class=\"line\">ssh-keygen</span><br><span class=\"line\">ssh-copy-id hdp-1</span><br><span class=\"line\">ssh-copy-id hdp-2</span><br><span class=\"line\">ssh-copy-id hdp-3</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> hdp-3</span></span><br><span class=\"line\">ssh-keygen</span><br><span class=\"line\">ssh-copy-id hdp-1</span><br><span class=\"line\">ssh-copy-id hdp-2</span><br><span class=\"line\">ssh-copy-id hdp-3</span><br></pre></td></tr></table></figure>\n<h3 id=\"64安装时间同步服务ntp\"><a class=\"markdownIt-Anchor\" href=\"#64安装时间同步服务ntp\"></a> 6.4.安装时间同步服务ntp</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">hdp-1</span></span><br><span class=\"line\">yum install -y ntp</span><br><span class=\"line\">vi /etc/ntp.conf</span><br><span class=\"line\">server 127.127.1.0</span><br><span class=\"line\">fudge 127.127.1.0 stratum 10</span><br><span class=\"line\">systemctl start ntpd</span><br><span class=\"line\">systemctl enable ntpd</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">hdp-2</span></span><br><span class=\"line\">yum install -y ntpdate</span><br><span class=\"line\">ntpdate hdp-1</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">hdp-3</span></span><br><span class=\"line\">yum install -y ntpdate</span><br><span class=\"line\">ntpdate hdp-1</span><br></pre></td></tr></table></figure>\n<h3 id=\"65关闭大页面压缩所有节点\"><a class=\"markdownIt-Anchor\" href=\"#65关闭大页面压缩所有节点\"></a> 6.5关闭大页面压缩(所有节点)</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class=\"line\">echo never &gt; /sys/kernel/mm/transparent_hugepage/defrag</span><br></pre></td></tr></table></figure>\n<h3 id=\"66安装配置jdk\"><a class=\"markdownIt-Anchor\" href=\"#66安装配置jdk\"></a> 6.6.安装配置JDK</h3>\n<p>将jdk的安装包上传到hdp-1</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">解压</span></span><br><span class=\"line\">tar -zxvf jdk-8u171-linux-x64.tar.gz -C /usr/local/</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置环境变量</span></span><br><span class=\"line\">vi /etc/profile</span><br><span class=\"line\">export JAVA_HOME=/usr/local/jdk</span><br><span class=\"line\">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</span><br><span class=\"line\">export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 刷新环境变量</span></span><br><span class=\"line\">source /ect/profile</span><br><span class=\"line\">java</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 将jdk和环境变量发送到其它机器</span></span><br><span class=\"line\">scp -r /usr/local/jdk  hdp-2:/usr/local/</span><br><span class=\"line\">scp -r /usr/local/jdk  hdp-3:/usr/local/</span><br><span class=\"line\">scp  /etc/profile hdp-2:/etc/</span><br><span class=\"line\">scp  /etc/profile hdp-3:/etc/</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> hdp-2 hdp-3</span></span><br><span class=\"line\">source /ect/profile</span><br><span class=\"line\">java</span><br></pre></td></tr></table></figure>\n<h3 id=\"67安装必要软件所有节点\"><a class=\"markdownIt-Anchor\" href=\"#67安装必要软件所有节点\"></a> 6.7.安装必要软件(所有节点)</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install libtirpc-devel</span><br><span class=\"line\">yum -y install psmisc</span><br><span class=\"line\">yum -y install redhat-lsb</span><br><span class=\"line\">yum -y install nc</span><br><span class=\"line\">yum -y install gcc</span><br><span class=\"line\">yum -y install python-devel</span><br><span class=\"line\">yum -y install python-kerberos-1.1-15.el7.x86_64</span><br><span class=\"line\">yum -y install rpcbind-0.2.0-49.el7.x86_64</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"68安装mysql数据库hdp-2安装hive可选\"><a class=\"markdownIt-Anchor\" href=\"#68安装mysql数据库hdp-2安装hive可选\"></a> 6.8.安装MySQL数据库(hdp-2，安装Hive可选)</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 安装</span></span><br><span class=\"line\">yum install -y mariadb-server</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 启动 开机自启</span></span><br><span class=\"line\">systemctl start mariadb &amp;&amp; systemctl enable mariadb</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 初始化</span></span><br><span class=\"line\">mysql_secure_installation</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 进入数据库</span></span><br><span class=\"line\">mysql -u root -p</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create database hive;</span><br><span class=\"line\">create user &quot;hive&quot;@&quot;%&quot; identified by &quot;hive&quot;;</span><br><span class=\"line\">grant all privileges on hive.* to &#x27;hive&#x27;@&#x27;%&#x27; identified by &#x27;hive&#x27;;</span><br><span class=\"line\">flush privileges;</span><br></pre></td></tr></table></figure>\n<h3 id=\"69安装和配置ambari-agent所有节点\"><a class=\"markdownIt-Anchor\" href=\"#69安装和配置ambari-agent所有节点\"></a> 6.9.安装和配置ambari-agent(所有节点)</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 安装</span></span><br><span class=\"line\">yum install -y ambari-agent</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 配置</span></span><br><span class=\"line\">vi /etc/ambari-agent/conf/ambari-agent.ini </span><br><span class=\"line\">[server]</span><br><span class=\"line\">hostname=ambari</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动</span></span><br><span class=\"line\">ambari-agent start</span><br></pre></td></tr></table></figure>\n<h1 id=\"7hdp部署\"><a class=\"markdownIt-Anchor\" href=\"#7hdp部署\"></a> 7.HDP部署</h1>\n<h2 id=\"71登录\"><a class=\"markdownIt-Anchor\" href=\"#71登录\"></a> 7.1登录</h2>\n<p>在浏览器中访问 <a href=\"http://172.18.74.160:8080\">http://172.18.74.160:8080</a></p>\n<p>默认的用户名和密码都是admin</p>\n<p><img src=\"image-20211009131454796.png\" class=\"lazyload placeholder\" data-srcset=\"image-20211009131454796.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20211009131454796\" /></p>\n<h2 id=\"72配置集群\"><a class=\"markdownIt-Anchor\" href=\"#72配置集群\"></a> 7.2配置集群</h2>\n<p><img src=\"20201010141301559.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141301559.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141325856.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141325856.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"202010101414045.png\" class=\"lazyload placeholder\" data-srcset=\"202010101414045.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141418882.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141418882.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141433923.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141433923.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141454782.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141454782.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141535201.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141535201.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141550200.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141550200.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141603805.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141603805.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141621700.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141621700.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"2020101014164097.png\" class=\"lazyload placeholder\" data-srcset=\"2020101014164097.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141651804.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141651804.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"20201010141707114.png\" class=\"lazyload placeholder\" data-srcset=\"20201010141707114.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"在这里插入图片描述\" /></p>\n<p><img src=\"image-20211009132110430.png\" class=\"lazyload placeholder\" data-srcset=\"image-20211009132110430.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"\" /></p>\n<p><img src=\"image-20211009132042277.png\" class=\"lazyload placeholder\" data-srcset=\"image-20211009132042277.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20211009132042277\" /></p>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2021/09/14/Linux%20Shell/Linux%20Shell%E5%9F%BA%E7%A1%80/",
            "url": "http://example.com/2021/09/14/Linux%20Shell/Linux%20Shell%E5%9F%BA%E7%A1%80/",
            "title": "Linux Shell基础",
            "date_published": "2021-09-14T00:19:12.000Z",
            "content_html": "<h2 id=\"1-shell基础\"><a class=\"markdownIt-Anchor\" href=\"#1-shell基础\"></a> 1 Shell基础</h2>\n<p>什么是shell？目前常用的操作系统（Windows、U/L、Android、iOS等）都带有图形界面，然 而，早期的计算机并没有图形界面，人们只能使用命令来控制计算机。其实，真 正能够控制计算机硬件（CPU、内存、显示器）的只有操作系统内核（Kernel）， 图形界面和命令行都是架设在用户和内核之间的桥梁，是为了方便用户控制计算 机而存在的。Shell 也是一种编程语言，主要用来开发一些实用的、自动化的小工具，例如，检测计算机的硬件参数、搭建Web运行环境、日志分析等。对Linux运维工程师来说，Shell更是必须掌握的技能。Shell使自动化管理服务器集群成为可能，否则用户只能一个一个地登录所有的服务器，对每一台服务器进行相同的设置，而这些服务器可能有成百上千之多，用户会在重复性的工作上浪费大量时间。</p>\n<h3 id=\"11查看shell版本\"><a class=\"markdownIt-Anchor\" href=\"#11查看shell版本\"></a> 1.1查看Shell版本</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat /ect/shells</span><br><span class=\"line\">/bin/sh</span><br><span class=\"line\">/bin/bash</span><br><span class=\"line\">/sbin/nologin</span><br><span class=\"line\">/usr/bin/sh</span><br><span class=\"line\">/usr/bin/bash</span><br><span class=\"line\">/usr/sbin/nologin</span><br></pre></td></tr></table></figure>\n<h3 id=\"12-shell变量类型\"><a class=\"markdownIt-Anchor\" href=\"#12-shell变量类型\"></a> 1.2 Shell变量类型</h3>\n<p>Shell变量分为四类，分别为自定义变量、环境变量、位置变量和预定义变量。</p>\n<ul>\n<li>根据工作要求临时定义的变量称为自定义变量</li>\n<li>环境变量一般是指用export内置命令导出的变量，用于定义Shell的运行环境，保证Shell命令的正确执行 只使用 不定义</li>\n<li>从命令行、函数或脚本执行等处传递参数时，$0、$1称为特殊位置变量</li>\n<li>预定义变量是在 bash 中已有的变量，可以直接使用，如<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi mathvariant=\"normal\">@</mi><mi mathvariant=\"normal\">、</mi></mrow><annotation encoding=\"application/x-tex\">@、</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">@</span><span class=\"mord cjk_fallback\">、</span></span></span></span>*等。</li>\n</ul>\n<h4 id=\"121-自定义变量\"><a class=\"markdownIt-Anchor\" href=\"#121-自定义变量\"></a> 1.2.1 自定义变量</h4>\n<p>自定义变量可以理解为局部变量或普通变量，只能在创建它们的Shell函数或Shell脚本中使用，自定义变量的说明如表所示。</p>\n<table>\n<thead>\n<tr>\n<th>定义自定义变量</th>\n<th>变量名=变量值，字母下划线开头，区分大小写</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>使用自定义变量</td>\n<td>$变量名</td>\n</tr>\n<tr>\n<td>查看自定义变量</td>\n<td>echo$变量名 set(所有变量)</td>\n</tr>\n<tr>\n<td>取消自定义变量</td>\n<td>unset 变量名</td>\n</tr>\n<tr>\n<td>自定义变量使用范围</td>\n<td>仅在当前Shell中有效</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">分支结构</span></span><br><span class=\"line\">host=www.baidu.com</span><br><span class=\"line\">if ping -c1 $host &amp;&gt;/dev/null</span><br><span class=\"line\">then</span><br><span class=\"line\">\techo &quot;network ok&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">\techo &quot;bad network&quot;</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>\n<h4 id=\"122环境变量\"><a class=\"markdownIt-Anchor\" href=\"#122环境变量\"></a> 1.2.2环境变量</h4>\n<p>环境变量也可称为全局变量，可以在创建它们的Shell及其派生出来的任意子进程Shell中使用。环境变量的说明如表所示。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">查看</span></span><br><span class=\"line\">echo $PATH</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">修改</span></span><br><span class=\"line\">PATH=$PATH:/bin/new</span><br><span class=\"line\">export PATH</span><br></pre></td></tr></table></figure>\n<h4 id=\"123位置变量\"><a class=\"markdownIt-Anchor\" href=\"#123位置变量\"></a> 1.2.3位置变量</h4>\n<p>在Shell中存在一些位置变量。位置变量用于在命令行、函数或脚本中传递参数，其变量名不用自己定义，其作用也是固定的。执行脚本时，通过在脚本后面给出具体的参数（多个参数用空格隔开）对相应的位置变量进行赋值。<br />\n$0代表命令本身，$1-$9代表接收的第1~9个参数，<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>10</mn><mi mathvariant=\"normal\">以</mi><mi mathvariant=\"normal\">上</mi><mi mathvariant=\"normal\">需</mi><mi mathvariant=\"normal\">要</mi><mi mathvariant=\"normal\">用</mi><mrow></mrow><mi mathvariant=\"normal\">括</mi><mi mathvariant=\"normal\">起</mi><mi mathvariant=\"normal\">来</mi><mi mathvariant=\"normal\">，</mi><mi mathvariant=\"normal\">如</mi></mrow><annotation encoding=\"application/x-tex\">10以上需要用{}括起来，如</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord cjk_fallback\">以</span><span class=\"mord cjk_fallback\">上</span><span class=\"mord cjk_fallback\">需</span><span class=\"mord cjk_fallback\">要</span><span class=\"mord cjk_fallback\">用</span><span class=\"mord\"></span><span class=\"mord cjk_fallback\">括</span><span class=\"mord cjk_fallback\">起</span><span class=\"mord cjk_fallback\">来</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">如</span></span></span></span>{10}代表接收的第10个参数。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[hadoop@master shell]$ cat ping06.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">ping -c1 $1 &amp;&gt;/dev/null</span><br><span class=\"line\"></span><br><span class=\"line\">if [ $? -eq &quot;0&quot; ];then</span><br><span class=\"line\">\techo &quot;network to $1 is ok&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">\techo &quot;bad network to $1&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\">[hadoop@master shell]$ sh ping06.sh www.baidu.com</span><br><span class=\"line\">network to www.baidu.com is ok</span><br></pre></td></tr></table></figure>\n<h4 id=\"124预定义变量\"><a class=\"markdownIt-Anchor\" href=\"#124预定义变量\"></a> 1.2.4预定义变量</h4>\n<table>\n<thead>\n<tr>\n<th>$0</th>\n<th>脚本名</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>$*</td>\n<td>所有参数</td>\n</tr>\n<tr>\n<td>$@</td>\n<td>所有参数</td>\n</tr>\n<tr>\n<td>$#</td>\n<td>参数的个数</td>\n</tr>\n<tr>\n<td>$$</td>\n<td>当前进程PID</td>\n</tr>\n<tr>\n<td>$!</td>\n<td>上一个进程PID</td>\n</tr>\n<tr>\n<td>$?</td>\n<td>上一个命令返回值，0代表成功</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[hadoop@master shell]$ ls &amp;</span><br><span class=\"line\">[1] 6950</span><br><span class=\"line\">[hadoop@master shell]$ ip.txt  ping03.sh  ping04.sh  ping05.sh  ping06.sh  ping07.sh  read</span><br><span class=\"line\"></span><br><span class=\"line\">[1]+  完成                  ls --color=auto</span><br><span class=\"line\">[hadoop@master shell]$ $!</span><br><span class=\"line\">-bash: 6950: 未找到命令</span><br><span class=\"line\"></span><br><span class=\"line\">[hadoop@master shell]$ cat ping07.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\">if [ $# -eq 0 ];then</span><br><span class=\"line\">\techo &quot;usage: `basename $0` filename&quot;</span><br><span class=\"line\">\texit</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">if [ ! -f $1 ];then</span><br><span class=\"line\">\techo &quot;filename error&quot;</span><br><span class=\"line\">\texit</span><br><span class=\"line\">fi</span><br><span class=\"line\">for ip in `cat $1`</span><br><span class=\"line\">do </span><br><span class=\"line\">\tping -c1 $ip</span><br><span class=\"line\">done</span><br><span class=\"line\">[hadoop@master shell]$ sh ping07.sh </span><br><span class=\"line\">usage: ping07.sh filename</span><br><span class=\"line\">[hadoop@master shell]$ sh ping07.sh ip.txt </span><br></pre></td></tr></table></figure>\n<h3 id=\"13变量的赋值\"><a class=\"markdownIt-Anchor\" href=\"#13变量的赋值\"></a> 1.3变量的赋值</h3>\n<h4 id=\"131显式赋值\"><a class=\"markdownIt-Anchor\" href=\"#131显式赋值\"></a> 1.3.1显式赋值</h4>\n<p>在Shell中，当第一次使用某变量名时，实际上就已经给变量赋值了。显式赋值的<br />\n格式为”变量名=变量值”。为了避免歧义，显式赋值时__禁止在等号两边添加空格__，<br />\n这跟常见的编程语言有所不同。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a=3</span><br></pre></td></tr></table></figure>\n<ul>\n<li>变量缺省为字符串类型</li>\n<li>变量值中有空格需要使用引号</li>\n<li>使用变量值进行赋值  name=“welcome to $place”</li>\n</ul>\n<h4 id=\"132从键盘赋值\"><a class=\"markdownIt-Anchor\" href=\"#132从键盘赋值\"></a> 1.3.2从键盘赋值</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">read -p &quot;Please enter a ip:&quot; ip</span><br><span class=\"line\">Please enter a ip:1.1.1.1</span><br><span class=\"line\">echo $ip</span><br><span class=\"line\">1.1.1.1</span><br></pre></td></tr></table></figure>\n<h4 id=\"133使用位置变量赋值\"><a class=\"markdownIt-Anchor\" href=\"#133使用位置变量赋值\"></a> 1.3.3使用位置变量赋值</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat test.sh</span><br><span class=\"line\">echo $1 $2</span><br><span class=\"line\">sh test.sh hello world</span><br><span class=\"line\">hello world</span><br></pre></td></tr></table></figure>\n<h4 id=\"134利用命令替换进行赋值\"><a class=\"markdownIt-Anchor\" href=\"#134利用命令替换进行赋值\"></a> 1.3.4利用命令替换进行赋值</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">today=`date +%F`</span><br><span class=\"line\">echo today</span><br><span class=\"line\">2021-10-2</span><br><span class=\"line\">touch `date +%F`_file.txt</span><br></pre></td></tr></table></figure>\n<p>双引号弱引用，单引号为强引用</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[hadoop@master shell]$ cat ping04.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">host=www.baidu.com</span><br><span class=\"line\">ping -c1 $host &amp;&gt;/dev/null</span><br><span class=\"line\">if [ $? -eq 0 ] </span><br><span class=\"line\">then</span><br><span class=\"line\">\techo &quot;network to $host is ok&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">\techo &quot;bad network to $host&quot;</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>\n<h3 id=\"14变量的运算\"><a class=\"markdownIt-Anchor\" href=\"#14变量的运算\"></a> 1.4变量的运算</h3>\n<h4 id=\"141expr数值运算命令\"><a class=\"markdownIt-Anchor\" href=\"#141expr数值运算命令\"></a> 1.4.1.expr数值运算命令</h4>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo 1 + 3</span><br><span class=\"line\">1 + 3</span><br><span class=\"line\">expr 1 + 3</span><br><span class=\"line\">4</span><br><span class=\"line\">res = `expr $name1 \\* $name2`</span><br><span class=\"line\">echo $res</span><br></pre></td></tr></table></figure>\n<ul>\n<li>在使用expr时，需要注意运算符及用于计算的数字两边必须有空格，否则会执行失败。</li>\n<li>expr 支持乘法运算，在使用乘号 * 时必须用反斜杠转义，即 \\*</li>\n</ul>\n<h4 id=\"142或数值运算命令\"><a class=\"markdownIt-Anchor\" href=\"#142或数值运算命令\"></a> 1.4.2.“$(())”或“[]”数值运算命令</h4>\n<ul>\n<li>双小括号 “$(())” 的作用是进行整数运算和数值比较，格式为“ ((表达式))”</li>\n<li>操作数、运算符两侧可以有空格</li>\n<li>括号内 $ 符合可省略</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">num1=10</span><br><span class=\"line\">num2=20</span><br><span class=\"line\">sum=$((num1+num2))</span><br><span class=\"line\">echo $sum</span><br><span class=\"line\">30</span><br><span class=\"line\">sum=$[ num1+num2 ]</span><br><span class=\"line\">echo $sum</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">可以使用加减乘除幂</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"143let数值运算命令\"><a class=\"markdownIt-Anchor\" href=\"#143let数值运算命令\"></a> 1.4.3.let数值运算命令</h4>\n<ul>\n<li>let数值符号可以直接进行计算，不需要使用 $ 符号。</li>\n<li>let运算命令的语法格式为：let 赋值表达式</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">let num=1+2</span><br><span class=\"line\">echo $num</span><br><span class=\"line\">3</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">调试模式</span></span><br><span class=\"line\">bash -vx test.sh</span><br></pre></td></tr></table></figure>\n<h4 id=\"144shell小数运算\"><a class=\"markdownIt-Anchor\" href=\"#144shell小数运算\"></a> 1.4.4Shell小数运算</h4>\n<ul>\n<li>bc是Unix/Linux下的计算器，它还可以作为命令进行小数运算。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &quot;2^4&quot;|bc</span><br><span class=\"line\">16</span><br><span class=\"line\">echo &quot;scale=2;6/4&quot;|bc</span><br><span class=\"line\">1.50</span><br></pre></td></tr></table></figure>\n<h3 id=\"15-变量的删除和替换\"><a class=\"markdownIt-Anchor\" href=\"#15-变量的删除和替换\"></a> 1.5 变量的删除和替换</h3>\n<p>Linux提供了一些可以直接对变量进行操作的符号。通过这些符号，变量中的部分内容可以被删除、替换和替代。在Shell变量中，变量的删除、替换和替代也是非常重要的。通过简单的操作修改变量，可以减少代码的行数并提高可读性。</p>\n<h4 id=\"151-变量的删除\"><a class=\"markdownIt-Anchor\" href=\"#151-变量的删除\"></a> 1.5.1 变量的删除</h4>\n<ul>\n<li>变量删除的操作方式，如表所示。</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>操作</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>${变量名#关键字符}</td>\n<td>如果变量内容从头开始的数据符合“关键字符”，则将符合的最短数据删除</td>\n</tr>\n<tr>\n<td>${变量名##关键字符}</td>\n<td>如果变量内容从头开始的数据符合“关键字符”，则将符合的最长数据删除</td>\n</tr>\n<tr>\n<td>${变量名%关键字符}</td>\n<td>如果变量内容从尾开始的数据符合“关键字符”，则将符合的最短数据删除</td>\n</tr>\n<tr>\n<td>${变量名%%关键字符}</td>\n<td>如果变量内容从尾开始的数据符合“关键字符”，则将符合的最长数据删除</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 ~]# url=www.bing.com</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url&#125;</span><br><span class=\"line\">www.bing.com</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;#url&#125;</span><br><span class=\"line\">12</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url&#125;</span><br><span class=\"line\">www.bing.com</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url#*.&#125;</span><br><span class=\"line\">bing.com</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url##*.&#125;</span><br><span class=\"line\">com</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url%.*&#125;</span><br><span class=\"line\">www.bing</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url%%.*&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>索引和切片</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url:0:5&#125;</span><br><span class=\"line\">www.b</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url:5:5&#125;</span><br><span class=\"line\">ing.c</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url:5:&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url:5&#125;</span><br><span class=\"line\">ing.com</span><br></pre></td></tr></table></figure>\n<h4 id=\"152-变量的替换\"><a class=\"markdownIt-Anchor\" href=\"#152-变量的替换\"></a> 1.5.2 变量的替换</h4>\n<table>\n<thead>\n<tr>\n<th>操作</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>${变量名/旧字符串/新字符串}</td>\n<td>表示若变量内容符和【旧字符串】则第一个【旧字符串】会被【新字符串】替换</td>\n</tr>\n<tr>\n<td>${变量名//旧字符串/新字符串}</td>\n<td>表示若变量内容符和【旧字符串】则全部的【旧字符串】会被【新字符串】替换</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url/bing/baidu&#125;</span><br><span class=\"line\">www.baidu.com</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url/b/B&#125;</span><br><span class=\"line\">www.Bing.com</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url/w/W&#125;</span><br><span class=\"line\">Www.bing.com</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url//w/W&#125;</span><br><span class=\"line\">WWW.bing.com</span><br></pre></td></tr></table></figure>\n<h4 id=\"153变量的替代\"><a class=\"markdownIt-Anchor\" href=\"#153变量的替代\"></a> 1.5.3变量的替代</h4>\n<ul>\n<li>给Shell变量设置默认值的格式为”${变量名-新的变量名}”，如果变量名没有被赋值，会使用”新的变量值”替代，如果变量已被赋值（包括空值），则该值不会被替代。</li>\n<li>变量替代常用于为变量设置缺省值。例如，在连接数据库时，需要使用端口，这个端口可以是预先设置的具体端口，也可以是用户输入的端口。假如用户没有输入具体的端口号，脚本中就使用预先设置的端口。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 ~]# unset url</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;url-www.heuet.edu.cn&#125;</span><br><span class=\"line\">www.heuet.edu.cn</span><br><span class=\"line\"></span><br><span class=\"line\">[root@hdp-1 ~]# host=hadoop</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;host-www.heuet.edu.cn&#125;</span><br><span class=\"line\">hadoop</span><br><span class=\"line\">[root@hdp-1 ~]# var=</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;var-www.heuet.edu.cn&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">[root@hdp-1 ~]# unset var1</span><br><span class=\"line\">[root@hdp-1 ~]# var2=</span><br><span class=\"line\">[root@hdp-1 ~]# var3=333</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;var1-111&#125;</span><br><span class=\"line\">111</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;var1:-111&#125;</span><br><span class=\"line\">111</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;var2:-111&#125;</span><br><span class=\"line\">111</span><br><span class=\"line\">[root@hdp-1 ~]# echo $&#123;var3:-111&#125;</span><br><span class=\"line\">333</span><br></pre></td></tr></table></figure>",
            "tags": [
                "Shell"
            ]
        },
        {
            "id": "http://example.com/2021/09/14/Linux%20Shell/Linux%20Shell%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84/",
            "url": "http://example.com/2021/09/14/Linux%20Shell/Linux%20Shell%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84/",
            "title": "Linux Shell循环结构",
            "date_published": "2021-09-14T00:19:12.000Z",
            "content_html": "<h2 id=\"3-循环结构\"><a class=\"markdownIt-Anchor\" href=\"#3-循环结构\"></a> 3 循环结构</h2>\n<ul>\n<li>Shell语言支持四种循环语句：for、while、until、select</li>\n<li>工作中常用的是 for、while、until</li>\n</ul>\n<h3 id=\"for循环语法结构\"><a class=\"markdownIt-Anchor\" href=\"#for循环语法结构\"></a> for循环语法结构</h3>\n<ul>\n<li>for循环主要用于确定次数的循环</li>\n<li>第一种for循环的语法结构如下所示：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for 变量名 in 取值列表</span><br><span class=\"line\">do</span><br><span class=\"line\">\t循环体</span><br><span class=\"line\">done</span><br></pre></td></tr></table></figure>\n<ul>\n<li>for循环语句实现批量主机ping探测</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat for_ping.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">for name in baidu 163 hao123</span><br><span class=\"line\">do</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\thost=www.$name.com</span><br><span class=\"line\">\tping -c1 -w1 $host &amp;&gt; /dev/null</span><br><span class=\"line\">\tif [ $? -eq 0 ];then</span><br><span class=\"line\">\t\techo &quot;$host&quot; | tee -a host.txt</span><br><span class=\"line\">\tfi</span><br><span class=\"line\">\t&#125;&amp;</span><br><span class=\"line\">done</span><br><span class=\"line\">wait</span><br><span class=\"line\">echo &quot;Mission Completed.&quot;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>for循环语句实现文件中批量用户创建</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat users_from_file.sh </span><br><span class=\"line\">IFS=$&#x27;\\n&#x27;</span><br><span class=\"line\">for line in `cat $1`</span><br><span class=\"line\">do</span><br><span class=\"line\">if [ $&#123;#line&#125; -eq 0 ];then</span><br><span class=\"line\">continue</span><br><span class=\"line\">fi</span><br><span class=\"line\">user=`echo &quot;$line&quot; | awk &#x27;&#123;print $1&#125;&#x27;`</span><br><span class=\"line\">pass=`echo &quot;$line&quot; | awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class=\"line\">id $user &amp;&gt;/dev/nuil</span><br><span class=\"line\">if [ $? -eq 0 ] ;then</span><br><span class=\"line\">echo &quot;user $user already exists&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">useradd $user</span><br><span class=\"line\">echo &quot;$pass&quot; | passwd --stdin $user &amp;&gt; /dev/null</span><br><span class=\"line\">if [ $? -eq 0 ];then</span><br><span class=\"line\">echo &quot;$user created&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\">fi</span><br><span class=\"line\">done</span><br></pre></td></tr></table></figure>\n<h3 id=\"while循环语句语法结构\"><a class=\"markdownIt-Anchor\" href=\"#while循环语句语法结构\"></a> while循环语句语法结构</h3>\n<ul>\n<li>while循环语句的基本语法为：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">while 条件测试</span><br><span class=\"line\">do</span><br><span class=\"line\">    循环体</span><br><span class=\"line\">done</span><br></pre></td></tr></table></figure>\n<ul>\n<li>while循环语句会对条件测试进行判断，如果条件测试成立时，则执行do和done之间的循环体，直到条件测试不成立才停止循环。</li>\n<li>while循环语句实现批量用户创建</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat while_user.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\">while read line</span><br><span class=\"line\">do</span><br><span class=\"line\">\tif [ $&#123;#line&#125; -eq 0 ];then</span><br><span class=\"line\">\t\techo &quot;NULL&quot;</span><br><span class=\"line\">\t\tcontinue</span><br><span class=\"line\">\tfi</span><br><span class=\"line\">\tuser=`echo $line | awk &#x27;&#123;print $1&#125;&#x27;`</span><br><span class=\"line\">\tpass=`echo $line | awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class=\"line\">\tid $user &amp;&gt;/dev/null</span><br><span class=\"line\">\tif [ $? -eq 0 ];then</span><br><span class=\"line\">\t\techo &quot;user $user already exists.&quot;</span><br><span class=\"line\">\telse</span><br><span class=\"line\">\t\tuseradd $user</span><br><span class=\"line\">\t\techo &quot;$pass&quot;| passwd --stdin $user &amp;&gt;/dev/null</span><br><span class=\"line\">\t\tif [ $? -eq 0 ] ;then</span><br><span class=\"line\">\t\t\techo &quot;$user created .&quot;</span><br><span class=\"line\">\t\tfi</span><br><span class=\"line\">\tfi</span><br><span class=\"line\">done &lt; $1</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"until循环语句语法结构\"><a class=\"markdownIt-Anchor\" href=\"#until循环语句语法结构\"></a> until循环语句语法结构</h3>\n<ul>\n<li>until循环语句基本语法为：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">until 条件测试</span><br><span class=\"line\">do</span><br><span class=\"line\">\t循环体</span><br><span class=\"line\">done</span><br></pre></td></tr></table></figure>\n<ul>\n<li>until循环语句是在条件表达式不成立时，进入循环体执行指令，条件表达式成立时，终止循环。until的应用场景很罕见。</li>\n<li>until循环语句测试远程主机可达性</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat until_ping.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\">host=www.baidu.com</span><br><span class=\"line\">until ping -c1 -w1 $host &amp;&gt;/dev/null</span><br><span class=\"line\">do</span><br><span class=\"line\">\tsleep 1</span><br><span class=\"line\">done</span><br><span class=\"line\">echo &quot;$host up. &quot;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "Shell"
            ]
        },
        {
            "id": "http://example.com/2021/09/14/Linux%20Shell/Linux%20Shell%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95/",
            "url": "http://example.com/2021/09/14/Linux%20Shell/Linux%20Shell%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95/",
            "title": "Linux Shell条件测试",
            "date_published": "2021-09-14T00:19:12.000Z",
            "content_html": "<h2 id=\"2-shell条件测试\"><a class=\"markdownIt-Anchor\" href=\"#2-shell条件测试\"></a> 2 Shell条件测试</h2>\n<h3 id=\"21-文件测试\"><a class=\"markdownIt-Anchor\" href=\"#21-文件测试\"></a> 2.1 文件测试</h3>\n<ul>\n<li>在Shell编程中，通常使用 test 命令进行条件测试</li>\n<li>语法形式为“test &lt;测试表达式&gt;”。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 ~]# test -d /home</span><br><span class=\"line\">[root@hdp-1 ~]# echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 ~]# test -d /homo</span><br><span class=\"line\">[root@hdp-1 ~]# echo $?</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n<ul>\n<li>test 条件测试在脚本中的应用</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat test_mysqlback.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/usr/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\">back_dir=~/mysql_back</span><br><span class=\"line\">if ! test -d $back_dir;then</span><br><span class=\"line\">\tmkdir -p $back_dir</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;开始备份...&quot;</span><br><span class=\"line\">[root@hdp-1 shell]# chmod +x test_mysqlback.sh </span><br><span class=\"line\">[root@hdp-1 shell]# bash -vx test_mysqlback.sh </span><br></pre></td></tr></table></figure>\n<ul>\n<li>除 test 外，还可以使用中括号或双中括号进行条件测试</li>\n<li>中括号 [ 是Shell的内置命令，不是标点符号</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# [ -d /home ]</span><br><span class=\"line\">[root@hdp-1 shell]# echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ -d /homo ]</span><br><span class=\"line\">[root@hdp-1 shell]# echo $?</span><br><span class=\"line\">1</span><br><span class=\"line\">[root@hdp-1 shell]# type -a [</span><br><span class=\"line\">[ 是 shell 内嵌</span><br><span class=\"line\">[ 是 /usr/bin/[</span><br><span class=\"line\">[root@hdp-1 shell]# [[ -d /home ]];echo $?</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n<ul>\n<li>文件测试操作符</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>操作</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-d</td>\n<td>测试是否为目录(Directory)</td>\n</tr>\n<tr>\n<td>-a</td>\n<td>测试目录或文件是否存在(Exist）</td>\n</tr>\n<tr>\n<td>-f</td>\n<td>测试是否为文件(File)</td>\n</tr>\n<tr>\n<td>-r</td>\n<td>测试当前用户是否可读（read)</td>\n</tr>\n<tr>\n<td>-w</td>\n<td>测试当前用户是否可写(write）</td>\n</tr>\n<tr>\n<td>-x</td>\n<td>测试当前用户是否可执行（cxcutc）</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# ll host.txt </span><br><span class=\"line\">-rw-r--r--. 1 root root 102 11月  2 15:41 host.txt</span><br><span class=\"line\">[root@hdp-1 shell]# [ -r host.txt ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# chmod -r host.txt </span><br><span class=\"line\">[root@hdp-1 shell]# ll host.txt </span><br><span class=\"line\">--w-------. 1 root root 102 11月  2 15:41 host.txt</span><br><span class=\"line\">[root@hdp-1 shell]# [ -r host.txt ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ -w host.txt ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ -x host.txt ];echo $?</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n<h3 id=\"22-整数测试\"><a class=\"markdownIt-Anchor\" href=\"#22-整数测试\"></a> 2.2 整数测试</h3>\n<ul>\n<li>整数测试通常用于数值之间的运算，其语法格式为 [ 整数1 操作符 整数2 ]</li>\n<li>或 test 整数1 操作符 整数2。</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>操作符</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-eq</td>\n<td>等于（Equal）</td>\n</tr>\n<tr>\n<td>-ne</td>\n<td>不等于(Not Equal)</td>\n</tr>\n<tr>\n<td>-gt</td>\n<td>大于(Greater Than)</td>\n</tr>\n<tr>\n<td>-lt</td>\n<td>小于(Lesser Than)</td>\n</tr>\n<tr>\n<td>-le</td>\n<td>小于或等于(Lesser or Equal)</td>\n</tr>\n<tr>\n<td>-ge</td>\n<td>大于或等于(Greater or Equal)</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>整数测试在脚本中的应用：创建新用户</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat create_user01.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">read -p &quot;Input a username: &quot; user</span><br><span class=\"line\">id $user &amp;&gt;/dev/null</span><br><span class=\"line\">if [ $? -eq 0 ];then</span><br><span class=\"line\">\techo &quot;user $user already exsits.&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">\tuseradd $user</span><br><span class=\"line\">\tif [ $? -eq 0 ];then</span><br><span class=\"line\">\t\techo &quot;$user created.&quot;</span><br><span class=\"line\">\tfi</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>\n<ul>\n<li>整数测试在脚本中的应用：磁盘可用空间告警</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat disk_use.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">. /etc/profile</span><br><span class=\"line\">disk_use=`df -Th |grep &#x27;/$&#x27;|awk &#x27;&#123;print $(NF-1)&#125;&#x27;|awk -F&quot;%&quot; &#x27;&#123;print $1&#125;&#x27;`</span><br><span class=\"line\">if [ $disk_use -ge 5 ];then</span><br><span class=\"line\">\techo &quot;`date +%F&quot; &quot;%T` disk used: $&#123;disk_use&#125;%&quot;</span><br><span class=\"line\">fi</span><br><span class=\"line\">[root@hdp-1 shell]# ./disk_use.sh </span><br><span class=\"line\">2021-12-06 14:53:46 disk used: 42%</span><br></pre></td></tr></table></figure>\n<ul>\n<li>整数测试在脚本中的应用：内存可用空间告警</li>\n<li>shell 语法检查：bash -n <a href=\"http://xxx.sh\">xxx.sh</a></li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat mem_use.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">mem_used=`free -m |grep &#x27;^M&#x27; |awk &#x27;&#123;print $3&#125;&#x27;`</span><br><span class=\"line\">mem_total=`free -m |grep &#x27;^M&#x27; |awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class=\"line\">mem_percent=$[mem_used*100/mem_total]</span><br><span class=\"line\">var_file=`date +%F`.log</span><br><span class=\"line\">if [ $mem_percent -ge 10 ];then</span><br><span class=\"line\">\techo &quot;`date +%F&quot; &quot;%T` memory used: $&#123;mem_percent&#125;%&quot; &gt;$var_file</span><br><span class=\"line\">fi</span><br><span class=\"line\">[root@hdp-1 shell]# ./mem_use.sh </span><br><span class=\"line\">[root@hdp-1 shell]# cat 2021-12-06.log </span><br><span class=\"line\">2021-12-06 14:54:44 memory used: 79%</span><br></pre></td></tr></table></figure>\n<h3 id=\"23-字符串测试\"><a class=\"markdownIt-Anchor\" href=\"#23-字符串测试\"></a> 2.3 字符串测试</h3>\n<ul>\n<li>字符串测试操作符的作用包括比较字符串是否相同、测试字符串的长度是否为0。书写表达式为[ 字符串1 = 字符串2 ]、[ 字符串1 ！= 字符串2 ]或[ -z 字符串 ]。字符串测试运算符如表所示。</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>符号</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-z</td>\n<td>判断字符串长度是否为0</td>\n</tr>\n<tr>\n<td>-n</td>\n<td>判断字符串长度是否为非0</td>\n</tr>\n<tr>\n<td>!</td>\n<td>判断两个字符串是否不相等</td>\n</tr>\n<tr>\n<td>=</td>\n<td>判断两个字符串是否相等</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# [ $USER = root ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ $USER = hadoop ];echo $?</span><br><span class=\"line\">1</span><br><span class=\"line\">[root@hdp-1 shell]# [ $USER != hadoop ];echo $?</span><br><span class=\"line\">0</span><br></pre></td></tr></table></figure>\n<ul>\n<li>双引号的作用</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# [ &quot;$USER&quot; != hadoop ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ &quot;$USER&quot; = root ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# echo $username</span><br><span class=\"line\"></span><br><span class=\"line\">[root@hdp-1 shell]# [ $username = root ];echo $?</span><br><span class=\"line\">-bash: [: =: 期待一元表达式</span><br><span class=\"line\">2</span><br><span class=\"line\">[root@hdp-1 shell]# [ &quot;$username&quot; = root ];echo $?</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n<ul>\n<li>字符串长度测试：空串、未定义变量的长度都是 0</li>\n<li>字符串必须使用双引号</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# var=&quot;&quot;</span><br><span class=\"line\">[root@hdp-1 shell]# echo $&#123;#var&#125;</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ -z $var ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ -n $var ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ -z &quot;$var&quot; ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [ -n &quot;$var&quot; ];echo $?</span><br><span class=\"line\">1</span><br></pre></td></tr></table></figure>\n<ul>\n<li>字符串测试在脚本中的应用</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat install.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">if [ $user ! = root ];then</span><br><span class=\"line\">\techo &quot;Permission Denied&quot;</span><br><span class=\"line\">\texit</span><br><span class=\"line\">fi</span><br><span class=\"line\"></span><br><span class=\"line\">yum install httpd</span><br></pre></td></tr></table></figure>\n<ul>\n<li>以上是安装服务的脚本，判断变量user的值是否为root，如果为root则安装httpd，<br />\n如果不是root，则显示”你没有权限”。</li>\n</ul>\n<h3 id=\"24-逻辑运算符\"><a class=\"markdownIt-Anchor\" href=\"#24-逻辑运算符\"></a> 2.4 逻辑运算符</h3>\n<ul>\n<li>在Shell条件测试中，使用逻辑运算符实现复杂的条件测试，逻辑运算符用于操作两个变量。逻辑运算符语法格式。</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[ 表达式1 ] 操作符 [ 表达式2 ]</span><br><span class=\"line\">or</span><br><span class=\"line\">命令1 操作符 命令2</span><br></pre></td></tr></table></figure>\n<ul>\n<li>逻辑操作符</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>运算符</th>\n<th>含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-a 或 &amp;&amp;</td>\n<td>判断操作符两边均为真，结果为真，否则为假，”逻辑与”</td>\n</tr>\n<tr>\n<td>-o 或 ||</td>\n<td>判断操作符两边一边为真，结果为真，否则为假，”逻辑或”</td>\n</tr>\n<tr>\n<td>!</td>\n<td>判断操作符两边均为假，结果为真，否则为假，”逻辑否”</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>-a和&amp;&amp;的运算规则。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# [ 1 -lt 2 -a 5 -gt 10 ];echo $?</span><br><span class=\"line\">1</span><br><span class=\"line\">[root@hdp-1 shell]# [ 1 -lt 2 -o 5 -gt 10 ];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# [[ 1 -lt 2 &amp;&amp; 5 -gt 10 ]];echo $?</span><br><span class=\"line\">1</span><br><span class=\"line\">[root@hdp-1 shell]# [[ 1 -lt 2 || 5 -gt 10 ]];echo $?</span><br><span class=\"line\">0</span><br><span class=\"line\">[root@hdp-1 shell]# </span><br></pre></td></tr></table></figure>\n<ul>\n<li>应用：创建批量用户</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat user_add.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">read -p &quot;Please input a username: &quot; user</span><br><span class=\"line\">id $user &amp;&gt;/dev/null</span><br><span class=\"line\">if [ $? -eq 0 ];then</span><br><span class=\"line\">\techo &quot;user $user already exists.&quot;</span><br><span class=\"line\">else</span><br><span class=\"line\">\tuseradd $user</span><br><span class=\"line\">\tif [ $? -eq 0 ];then</span><br><span class=\"line\">\t\techo &quot;user created.&quot;</span><br><span class=\"line\">\tfi</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>\n<ul>\n<li>应用：创建批量用户</li>\n</ul>\n<h3 id=\"case-条件语句\"><a class=\"markdownIt-Anchor\" href=\"#case-条件语句\"></a> case 条件语句</h3>\n<ul>\n<li>case条件语句相当于多分支的if/elif/else条件语句</li>\n<li>case条件语句比if语句更加简洁工整，故常应用在实现系统服务启动脚本等应用场景中。</li>\n<li>在Shell编程中，case语句有固定的语法格式。其语法格式为：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">case 变量值 in</span><br><span class=\"line\">  条件表达式1）</span><br><span class=\"line\">    代码块1</span><br><span class=\"line\">    ；；</span><br><span class=\"line\">  条件表达式2）</span><br><span class=\"line\">    代码块2</span><br><span class=\"line\">    ；；</span><br><span class=\"line\">  条件表达式3）</span><br><span class=\"line\">    代码块3</span><br><span class=\"line\">    ；；</span><br><span class=\"line\">  *）</span><br><span class=\"line\">    默认代码块</span><br><span class=\"line\">esac</span><br></pre></td></tr></table></figure>\n<ul>\n<li>条件表达式匹配如表所示。</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>条件表达式</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>*</td>\n<td>任意字符</td>\n</tr>\n<tr>\n<td>?</td>\n<td>任意单个字符</td>\n</tr>\n<tr>\n<td>[abc]</td>\n<td>其中之一</td>\n</tr>\n<tr>\n<td>[a-z]</td>\n<td>区间之一</td>\n</tr>\n<tr>\n<td>|</td>\n<td>多重选择</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>case条件语句案例实战</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat user_del.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> delete user</span></span><br><span class=\"line\"></span><br><span class=\"line\">read -p &quot;Input a username: &quot; user</span><br><span class=\"line\">id $user &amp;&gt;/dev/null</span><br><span class=\"line\">if [ $? -ne 0 ];then</span><br><span class=\"line\">\techo &quot;no such user: $user&quot;</span><br><span class=\"line\">\texit 1</span><br><span class=\"line\">fi</span><br><span class=\"line\">read -p &quot;Are you sure?[y/n]: &quot; action</span><br><span class=\"line\">case &quot;$action&quot; in</span><br><span class=\"line\">y|Y|yes|YES)</span><br><span class=\"line\">\tuserdel -r $user</span><br><span class=\"line\">\techo &quot;user $user deleted. &quot;</span><br><span class=\"line\">\t;;</span><br><span class=\"line\">*)</span><br><span class=\"line\">\techo &quot;error! &quot;</span><br><span class=\"line\">\texit 2</span><br><span class=\"line\">esac</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "Shell"
            ]
        },
        {
            "id": "http://example.com/2021/09/14/Linux%20Shell/Linux%20Shell%E8%BF%9B%E9%98%B6/",
            "url": "http://example.com/2021/09/14/Linux%20Shell/Linux%20Shell%E8%BF%9B%E9%98%B6/",
            "title": "Linux Shell进阶",
            "date_published": "2021-09-14T00:19:12.000Z",
            "content_html": "<h2 id=\"4-并发控制\"><a class=\"markdownIt-Anchor\" href=\"#4-并发控制\">#</a> 4 并发控制</h2>\n<ul>\n<li>默认情况下，Shell 命令是串行方式自上而下执行的，但如果有大量的命令需要执行，串行就会浪费大量的时间，这就需要采用并发执行。</li>\n</ul>\n<h3 id=\"41-利用后台执行实现并发\"><a class=\"markdownIt-Anchor\" href=\"#41-利用后台执行实现并发\">#</a> 4.1 利用后台执行实现并发</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat back_ping.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">for i in &#123;1..254&#125;</span><br><span class=\"line\">do </span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\tip=10.10.10.$i</span><br><span class=\"line\">\tping -c1 -w1 $ip &amp;&gt; /dev/null</span><br><span class=\"line\">\tif [ $? -eq 0 ];then</span><br><span class=\"line\">\t\techo &quot;$ip is up.&quot;</span><br><span class=\"line\">\telse</span><br><span class=\"line\">\t\techo &quot;$ip is down.&quot;</span><br><span class=\"line\">\tfi</span><br><span class=\"line\">\t&#125;&amp;</span><br><span class=\"line\">done</span><br><span class=\"line\">wait</span><br><span class=\"line\">echo &quot;Mission Completed&quot;</span><br></pre></td></tr></table></figure>\n<h3 id=\"利用管道实现并发控制\"><a class=\"markdownIt-Anchor\" href=\"#利用管道实现并发控制\">#</a> 利用管道实现并发控制</h3>\n<ul>\n<li>使用 Linux 管道文件特性制作队列，可以控制并发数量。</li>\n<li>管道分为命名管道和匿名管道。</li>\n<li>创建命名管道文件命令是 mkfifo</li>\n<li>命名管道可跨终端实现数据交换</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat 255_ping.sh </span><br><span class=\"line\">thread=5</span><br><span class=\"line\">tmp_fifofile=/tmp/$$.fifo</span><br><span class=\"line\">mkfifo $tmp_fifofile</span><br><span class=\"line\">exec 8&lt;&gt;$tmp_fifofile</span><br><span class=\"line\">rm $tmp_fifofile</span><br><span class=\"line\">for i in `seq $thread`</span><br><span class=\"line\">do</span><br><span class=\"line\">\techo &gt;&amp;8</span><br><span class=\"line\">done</span><br><span class=\"line\"></span><br><span class=\"line\">for i in &#123;1..254&#125;</span><br><span class=\"line\">do</span><br><span class=\"line\">\tread -u 8</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tip=10.0.0.$i</span><br><span class=\"line\">\t\tping -c1 -w1 $ip &amp;&gt;/dev/null</span><br><span class=\"line\">\t\tif [ $? -eq 0 ];then</span><br><span class=\"line\">\t\t\techo &quot;$ip is up.&quot;</span><br><span class=\"line\">\t\telse</span><br><span class=\"line\">\t\t\techo &quot;$ip is down . &quot;</span><br><span class=\"line\">\t\tfi</span><br><span class=\"line\">\t\techo &gt;&amp;8</span><br><span class=\"line\">\t&#125;&amp;</span><br><span class=\"line\">done</span><br><span class=\"line\">wait</span><br><span class=\"line\">exec 8&gt;&amp;-</span><br><span class=\"line\">echo &quot;misson completed.&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"5-shell-数组\"><a class=\"markdownIt-Anchor\" href=\"#5-shell-数组\">#</a> 5 Shell 数组</h2>\n<h3 id=\"51-shell数组的基本概念\"><a class=\"markdownIt-Anchor\" href=\"#51-shell数组的基本概念\">#</a> 5.1 Shell 数组的基本概念</h3>\n<ul>\n<li>用于区分不同元素的编号称为数组下标。</li>\n<li>数组的元素有时也称为下标变量。</li>\n<li>数组分为普通数组和关联数组</li>\n<li>普通数组中的索引是整数，关联数组的数组索引可以用文本。</li>\n<li>关联数组使用之前需要声明</li>\n<li>关联数组由键值对组成。</li>\n</ul>\n<h4 id=\"511-普通数组\"><a class=\"markdownIt-Anchor\" href=\"#511-普通数组\">#</a> 5.1.1 普通数组</h4>\n<ul>\n<li>普通数组中：数组元素的索引（下标）从 0 开始编号，获取数组中的元素要利用索引（下标）。索引（下标）可以是算术表达式，其结果必须是一个整数。</li>\n<li>普通数组定义。</li>\n<li>下标从 0 开始</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# books=(linux shell awk openstack docker)</span><br><span class=\"line\">[root@hdp-1 shell]# echo $&#123;books[3]&#125;</span><br><span class=\"line\">openstack</span><br></pre></td></tr></table></figure>\n<h4 id=\"512-关联数组\"><a class=\"markdownIt-Anchor\" href=\"#512-关联数组\">#</a> 5.1.2 关联数组</h4>\n<ul>\n<li>关联数组和普通数组所不同的是，它的索引下标可以是任意的整数和字符串。</li>\n<li>关联数组定义。eg: info=([name]=tianyun [sex]=male [age]=36 [height]=170 [skill]=cloud)</li>\n</ul>\n<h4 id=\"513-数组声明\"><a class=\"markdownIt-Anchor\" href=\"#513-数组声明\">#</a> 5.1.3 数组声明</h4>\n<ul>\n<li>关联数组需要先声明后使用。</li>\n<li>通常情况下 Shell 解释器隐式声明普通数组。</li>\n<li>声明普通数组的方法为：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">declare -a array</span><br></pre></td></tr></table></figure>\n<ul>\n<li>声明关联数组的方法为：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">declare -A array</span><br></pre></td></tr></table></figure>\n<h3 id=\"52-shell数组的定义\"><a class=\"markdownIt-Anchor\" href=\"#52-shell数组的定义\">#</a> 5.2 Shell 数组的定义</h3>\n<ul>\n<li>在 Linux Shell 中，定义一个数组有多种方法，需要先按照命令规则给数组命名，然后再定义数组的值。数组的定义方法有直接定义数组、下标定义数组、间接定义数组和从文件中读入定义数组，接下来详细介绍定义数组的方法。</li>\n</ul>\n<h4 id=\"521-直接定义数组\"><a class=\"markdownIt-Anchor\" href=\"#521-直接定义数组\">#</a> 5.2.1 直接定义数组</h4>\n<ul>\n<li>直接定义数组是用小括号将变量值括起来赋值给数组变量，每个变量值之间要用空隔进行分隔。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# books=(linux shell awk openstack docker)</span><br><span class=\"line\">[root@hdp-1 shell]# echo $&#123;books[3]&#125;</span><br><span class=\"line\">openstack</span><br></pre></td></tr></table></figure>\n<h4 id=\"522-下标定义数组\"><a class=\"markdownIt-Anchor\" href=\"#522-下标定义数组\">#</a> 5.2.2 下标定义数组</h4>\n<ul>\n<li>下标定义数组是用小括号将变量值括起来，同时采用键值对的形式赋值。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">array_name=([1]=value1 [2]=value2 [3]=value3 ...)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>此种方法为 key-value 键值对的形式，小括号里对应的数字为数组下标，等号后面的内容为下标对应的数组变量的值。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# declare -A info</span><br><span class=\"line\">[root@hdp-1 shell]# info=([name]=tianyun [sex]=male [age]=36 [height]=170 [skill]=cloud)</span><br><span class=\"line\">[root@hdp-1 shell]# echo $&#123;info[name]&#125;</span><br><span class=\"line\">tianyun</span><br><span class=\"line\">[root@hdp-1 shell]# echo $&#123;info[skill]&#125;</span><br><span class=\"line\">cloud</span><br></pre></td></tr></table></figure>\n<h4 id=\"523-间接定义数组\"><a class=\"markdownIt-Anchor\" href=\"#523-间接定义数组\">#</a> 5.2.3 间接定义数组</h4>\n<ul>\n<li>间接定义数组是分别通过定义数组的方法来定义。其语法格式为：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">array_name[0]=value1;array_name[1]=value2;array_name[2]=value3 </span><br></pre></td></tr></table></figure>\n<ul>\n<li>此种方法要求一次赋一个值，比较复杂。具体如下所示。</li>\n<li>间接定义数组。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# array[0]=pear</span><br><span class=\"line\">[root@hdp-1 shell]# array[1]=apple</span><br><span class=\"line\">[root@hdp-1 shell]# array[2]=orange</span><br><span class=\"line\">[root@hdp-1 shell]# echo $&#123;array[1]&#125;</span><br><span class=\"line\">apple</span><br><span class=\"line\">[root@hdp-1 shell]# echo &quot;You are the $&#123;array[1]&#125; of my eye.&quot;</span><br><span class=\"line\">You are the apple of my eye.</span><br></pre></td></tr></table></figure>\n<h4 id=\"524-从文件中读入定义数组\"><a class=\"markdownIt-Anchor\" href=\"#524-从文件中读入定义数组\">#</a> 5.2.4 从文件中读入定义数组</h4>\n<ul>\n<li>从文件中读入定义数组是使用命令的输出结果作为数组的内容。其语法格式为：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">array_name=($&#123;命令&#125;)</span><br><span class=\"line\">数组名=($(`变量名`))</span><br><span class=\"line\">或者</span><br><span class=\"line\">array_name=(`命令`)</span><br><span class=\"line\">数组名=(`变量值`)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>这种方法要求一次赋多个值。</li>\n<li>从文件中读入定义数组。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# array=(`cat /etc/passwd`)</span><br><span class=\"line\">[root@hdp-1 shell]# echo $&#123;array[*]&#125;</span><br><span class=\"line\">root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>\n<h3 id=\"53-shell数组的遍历及赋值\"><a class=\"markdownIt-Anchor\" href=\"#53-shell数组的遍历及赋值\">#</a> 5.3 Shell 数组的遍历及赋值</h3>\n<h4 id=\"531-常见的访问shell数组表达式\"><a class=\"markdownIt-Anchor\" href=\"#531-常见的访问shell数组表达式\">#</a> 5.3.1 常见的访问 Shell 数组表达式</h4>\n<ul>\n<li>表列出了常见访问数组的表达式。</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>语法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td !array[*]=\"\">echo $</td>\n<td>访问数组所有索引</td>\n</tr>\n<tr>\n<td !array[@]=\"\">echo $</td>\n<td>访问数组所有索引</td>\n</tr>\n<tr>\n<td array[*]=\"\">echo $</td>\n<td>访问数组所有值</td>\n</tr>\n<tr>\n<td array[@]=\"\">echo $</td>\n<td>访问数组所有值</td>\n</tr>\n<tr>\n<td id=\"array[@]\">echo $</td>\n<td>统计数组元素个数</td>\n</tr>\n<tr>\n<td array[0]=\"\">echo $</td>\n<td>访问数组中的第一个元素</td>\n</tr>\n<tr>\n<td array[@]:1=\"\">echo $</td>\n<td>从数组下标 1 开始</td>\n</tr>\n<tr>\n<td array[@]:1:2=\"\">echo $</td>\n<td>从数组下标 1 开始，访问两个元素</td>\n</tr>\n<tr>\n<td id=\"array[#]\">echo $</td>\n<td>第 #个元素的字符个数</td>\n</tr>\n<tr>\n<td id=\"array\">echo $</td>\n<td>第 0 个元素的字符个数</td>\n</tr>\n<tr>\n<td array[#]=\"\">echo $</td>\n<td>显示第 #个元素</td>\n</tr>\n<tr>\n<td array=\"\">echo $</td>\n<td>显示第 0 个与元素</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"532-while循环实现shell数组的遍历\"><a class=\"markdownIt-Anchor\" href=\"#532-while循环实现shell数组的遍历\">#</a> 5.3.2 while 循环实现 Shell 数组的遍历</h4>\n<ul>\n<li>以 host 文件的每一行作为数组的一个元素来赋值，并对该数组进行遍历。具体如下所示。</li>\n<li>while 循环实现 Shell 数组的遍历。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat array_host_while.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">while read line</span><br><span class=\"line\">do</span><br><span class=\"line\">\thosts[++i]=$line</span><br><span class=\"line\"></span><br><span class=\"line\">done &lt;/etc/hosts</span><br><span class=\"line\"></span><br><span class=\"line\">echo &quot;hosts first : $&#123;hosts[1]&#125;&quot;</span><br><span class=\"line\">echo</span><br><span class=\"line\"></span><br><span class=\"line\">for i in $&#123;!hosts[@]&#125;</span><br><span class=\"line\">do</span><br><span class=\"line\">\techo &quot;$i: $&#123;hosts[i]&#125;&quot;</span><br><span class=\"line\">done</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>while 读入 /etc/hosts 文件的每一行并把它显示出来，hosts [++i]=<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mtext>这个表达式完成数组的赋值操作，</mtext></mrow><annotation encoding=\"application/x-tex\">line这个表达式完成数组的赋值操作，</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">e</span><span class=\"mord cjk_fallback\">这</span><span class=\"mord cjk_fallback\">个</span><span class=\"mord cjk_fallback\">表</span><span class=\"mord cjk_fallback\">达</span><span class=\"mord cjk_fallback\">式</span><span class=\"mord cjk_fallback\">完</span><span class=\"mord cjk_fallback\">成</span><span class=\"mord cjk_fallback\">数</span><span class=\"mord cjk_fallback\">组</span><span class=\"mord cjk_fallback\">的</span><span class=\"mord cjk_fallback\">赋</span><span class=\"mord cjk_fallback\">值</span><span class=\"mord cjk_fallback\">操</span><span class=\"mord cjk_fallback\">作</span><span class=\"mord cjk_fallback\">，</span></span></span></span>{!hosts [@]} 这个表达式获得数组的索引，${hosts [i]} 这个表达式完成了数组的遍历。</li>\n<li>执行结果如下：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# ./array_host_while.sh </span><br><span class=\"line\">hosts first : 127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class=\"line\"></span><br><span class=\"line\">1: 127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class=\"line\">2: ::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class=\"line\">3: </span><br><span class=\"line\">4: 172.18.*.* as</span><br><span class=\"line\">5: 172.18.*.* hdp-1</span><br><span class=\"line\">6: 172.18.*.* hdp-2</span><br><span class=\"line\">7: 172.18.*.* hdp-3</span><br></pre></td></tr></table></figure>\n<h4 id=\"533-for循环实现shell数组的遍历\"><a class=\"markdownIt-Anchor\" href=\"#533-for循环实现shell数组的遍历\">#</a> 5.3.3 for 循环实现 Shell 数组的遍历</h4>\n<ul>\n<li>当一个脚本需要传入的参数较多时，可以使用 for 循环进行参数遍历。具体如下例所示。</li>\n<li>for 循环实现 Shell 数组的遍历。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# cat array_host_for.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"><span class=\"keyword\">for</span> array</span></span><br><span class=\"line\">OLD_IFS=$IFS</span><br><span class=\"line\">IFS=$&#x27;\\n&#x27; </span><br><span class=\"line\">for line in `cat /etc/hosts`</span><br><span class=\"line\">do</span><br><span class=\"line\">hosts[++j]=$line</span><br><span class=\"line\">done</span><br><span class=\"line\">for i in $&#123;!hosts[@]&#125;</span><br><span class=\"line\">do</span><br><span class=\"line\">\techo &quot;$i: $&#123;hosts[i]&#125;&quot;</span><br><span class=\"line\">done</span><br></pre></td></tr></table></figure>\n<ul>\n<li>定义一个数组 hosts 以 /etc/hosts 每一行内容作为数组的元素进行遍历。</li>\n<li>执行结果如下：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# ./array_host_for.sh </span><br><span class=\"line\">1: 127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class=\"line\">2: ::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class=\"line\">3: </span><br><span class=\"line\">4: 172.18.*.* as</span><br><span class=\"line\">5: 172.18.*.* hdp-1</span><br><span class=\"line\">6: 172.18.*.* hdp-2</span><br><span class=\"line\">7: 172.18.*.* hdp-3</span><br></pre></td></tr></table></figure>\n<h2 id=\"6-shell函数\"><a class=\"markdownIt-Anchor\" href=\"#6-shell函数\">#</a> 6 Shell 函数</h2>\n<h3 id=\"61-shell函数的概念\"><a class=\"markdownIt-Anchor\" href=\"#61-shell函数的概念\">#</a> 6.1 Shell 函数的概念</h3>\n<ul>\n<li>函数是由若干条 Shell 命令组成的语句块，实现代码重用和模块化编程，它不是一个单独的进程，不能独立运行，它只是 Shell 程序的一部分。</li>\n<li>Shell 函数和 Shell 程序比较相似，区别在于：Shell 程序在子 Shell 中运行，而 Shell 函数在当前 Shell 中运行，因此在当前 Shell 中，函数可以对 Shell 变量进行修改。</li>\n<li>函数可以提高程序的可读性和重用性。</li>\n</ul>\n<h3 id=\"62-shell函数的语法\"><a class=\"markdownIt-Anchor\" href=\"#62-shell函数的语法\">#</a> 6.2 Shell 函数的语法</h3>\n<ul>\n<li>Shell 函数的语法格式为：</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">函数名()&#123;</span><br><span class=\"line\">\t代码块</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">or</span><br><span class=\"line\">function 函数名 &#123;</span><br><span class=\"line\">\t代码块</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>关键字 function 表示定义一个函数，可以省略，其后是函数名，两个大括号之间是函数体。创建的函数可以在别的脚本中被调用。</li>\n</ul>\n<h3 id=\"63-shell函数的调用\"><a class=\"markdownIt-Anchor\" href=\"#63-shell函数的调用\">#</a> 6.3 Shell 函数的调用</h3>\n<h4 id=\"631-shell函数的传参介绍\"><a class=\"markdownIt-Anchor\" href=\"#631-shell函数的传参介绍\">#</a> 6.3.1 Shell 函数的传参介绍</h4>\n<ul>\n<li>最基本的语法格式为：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">函数名</span><br></pre></td></tr></table></figure>\n<ul>\n<li>带有参数的语法格式为：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">函数名 参数1 参数2</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Shell 的位置参数（$1、$2、…）可以作为函数的参数来使用。其中，$1 表示第一个参数，$2 表示第二个参数。</li>\n<li>当 n≥10 时，需要使用 ${n} 来获取参数。例如，获取第十个参数不能用<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>10</mn><mtext>，需要用</mtext></mrow><annotation encoding=\"application/x-tex\">10，需要用</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">需</span><span class=\"mord cjk_fallback\">要</span><span class=\"mord cjk_fallback\">用</span></span></span></span> {10}。</li>\n</ul>\n<h3 id=\"64-shell函数的应用实战\"><a class=\"markdownIt-Anchor\" href=\"#64-shell函数的应用实战\">#</a> 6.4 Shell 函数的应用实战</h3>\n<h4 id=\"641-脚本中调用shell函数\"><a class=\"markdownIt-Anchor\" href=\"#641-脚本中调用shell函数\">#</a> 6.4.1 脚本中调用 Shell 函数</h4>\n<ul>\n<li>函数必须在使用前需要先被定义。因此，在脚本中使用函数时，必须在脚本开始前定义函数，调用函数仅使用函数名即可</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# ./function.sh </span><br><span class=\"line\">5的阶乘是: 120</span><br><span class=\"line\">[root@hdp-1 shell]# cat function.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">factorial()&#123;</span><br><span class=\"line\">\tfactorial=1</span><br><span class=\"line\">\tfor((i=1;i&lt;=5;i++))</span><br><span class=\"line\">\tdo</span><br><span class=\"line\">\t\tfactorial=$[$factorial * $i]</span><br><span class=\"line\">\tdone</span><br><span class=\"line\">\techo &quot;5的阶乘是: $factorial&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">factorial</span><br></pre></td></tr></table></figure>\n<ul>\n<li>接下来使用带有可以传参调用的函数来写一个计算阶乘的脚本</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# ./function.sh 5</span><br><span class=\"line\">5的阶乘是: 120</span><br><span class=\"line\">[root@hdp-1 shell]# cat function.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">factorial()&#123;</span><br><span class=\"line\">\tfactorial=1</span><br><span class=\"line\">\tfor((i=1;i&lt;=$1;i++))</span><br><span class=\"line\">\tdo</span><br><span class=\"line\">\t\tfactorial=$[$factorial * $i]</span><br><span class=\"line\">\tdone</span><br><span class=\"line\">\techo &quot;5的阶乘是: $factorial&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">factorial $1 </span><br></pre></td></tr></table></figure>\n<ul>\n<li>函数的位置参数与脚本的位置参数</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# ./position_func.sh 2 3 4</span><br><span class=\"line\">result is : 24</span><br><span class=\"line\">[root@hdp-1 shell]# cat position_func.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">if [ $# -ne 3 ];then</span><br><span class=\"line\">\techo &quot;usage: `basename $0` p1 p2 p3&quot;</span><br><span class=\"line\">\texit</span><br><span class=\"line\">fi</span><br><span class=\"line\">fun()&#123;</span><br><span class=\"line\">\techo &quot;$[$1*$2*$3]&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">result</span></span><br><span class=\"line\">result=`fun $1 $2 $3`</span><br><span class=\"line\">echo &quot;result is : $result&quot;</span><br></pre></td></tr></table></figure>\n<h4 id=\"642-shell函数的返回值\"><a class=\"markdownIt-Anchor\" href=\"#642-shell函数的返回值\">#</a> 6.4.2 Shell 函数的返回值</h4>\n<ul>\n<li>函数有两种返回值，分别为执行结果的返回值和退出状态码。</li>\n<li>函数的退出状态码取决于函数中执行的最后一条命令的退出状态码。</li>\n<li>自定义退出状态码的语法格式为：</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">return 0 无错误返回</span><br><span class=\"line\">return 1-255 有错误返回</span><br></pre></td></tr></table></figure>\n<ul>\n<li>退出状态码使用 return 保留字返回</li>\n<li>return 的返回值只能是 0~255 的一个整数</li>\n<li>执行结果的返回值不使用 return</li>\n<li>执行结果的返回值将保存到变量 “$?” 中</li>\n<li>函数执行结果的的返回值。</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# ./return.sh </span><br><span class=\"line\">Enter a Number: 3</span><br><span class=\"line\">fun2 return value: 0</span><br><span class=\"line\">[root@hdp-1 shell]# cat return.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">fun2()&#123;</span><br><span class=\"line\">\tread -p &quot;Enter a Number: &quot; num</span><br><span class=\"line\">\tlet 2*num</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">fun2</span><br><span class=\"line\">echo &quot;fun2 return value: $?&quot;</span><br></pre></td></tr></table></figure>\n<h4 id=\"643-shell函数数组变量的传参\"><a class=\"markdownIt-Anchor\" href=\"#643-shell函数数组变量的传参\">#</a> 6.4.3 Shell 函数数组变量的传参</h4>\n<ul>\n<li>向函数中传递数组</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@hdp-1 shell]# ./array_func.sh </span><br><span class=\"line\">120</span><br><span class=\"line\">[root@hdp-1 shell]# cat array_func.sh </span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">num=(1 2 3 4 5)</span><br><span class=\"line\"></span><br><span class=\"line\">array()&#123;</span><br><span class=\"line\">\tresult=1</span><br><span class=\"line\">\tfor i in &quot;$@&quot;</span><br><span class=\"line\">\tdo</span><br><span class=\"line\">\t\tresult=$[$result*$i]</span><br><span class=\"line\">\tdone</span><br><span class=\"line\">\techo &quot;$result&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">array $&#123;num[@]&#125;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "Shell"
            ]
        },
        {
            "id": "http://example.com/2021/06/21/%E5%B9%B3%E5%8F%B0/Windows%20%E5%AE%9A%E6%97%B6%E5%BC%80%E6%9C%BA%E3%80%81%E8%81%94%E7%BD%91%E3%80%81%E6%89%93%E5%BC%80%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/",
            "url": "http://example.com/2021/06/21/%E5%B9%B3%E5%8F%B0/Windows%20%E5%AE%9A%E6%97%B6%E5%BC%80%E6%9C%BA%E3%80%81%E8%81%94%E7%BD%91%E3%80%81%E6%89%93%E5%BC%80%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1/",
            "title": "Windows 定时开机、联网、打开远程服务",
            "date_published": "2021-06-21T03:40:59.000Z",
            "content_html": "<h1 id=\"windows-定时开机-联网-打开远程服务\"><a class=\"markdownIt-Anchor\" href=\"#windows-定时开机-联网-打开远程服务\"></a> Windows 定时开机、联网、打开远程服务</h1>\n<p>作者：SSR</p>\n<h2 id=\"设置定时任务\"><a class=\"markdownIt-Anchor\" href=\"#设置定时任务\"></a> 设置定时任务</h2>\n<ol>\n<li>右键此电脑&gt;管理&gt;任务计划程序&gt;任务计划库</li>\n<li>在右侧创建任务<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172358836.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172358836.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210621172358836\" /></li>\n<li>输入事件名称，选择不管是否登陆都要执行（关键！确保开机不登录也运行）<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172519107.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172519107.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210621172519107\" /></li>\n<li>添加触发器1，选择启动时<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172654148.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172654148.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210621172654148\" /></li>\n<li>添加触发器2，选择每日特定时间<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172812758.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172812758.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210621172812758\" /></li>\n<li>添加操作并指定联网脚本（理论上java、python都随意，这里使用批处理脚本）<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172957100.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621172957100.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210621172957100\" /></li>\n<li>添加操作，指定打开远程连接软件ToDesk(<a href=\"http://www.todesk.com\">www.todesk.com</a>)<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621173149721.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210621173149721.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210621173149721\" /></li>\n<li>点击确定完成设置</li>\n</ol>\n<h2 id=\"设置bios启动\"><a class=\"markdownIt-Anchor\" href=\"#设置bios启动\"></a> 设置BIOS启动</h2>\n<ol>\n<li>打开开始&gt;设置&gt;更新和安全&gt;恢复&gt;立即重新启动&gt;疑难解答&gt;高级选项&gt;UEFI固件设置&gt;重启</li>\n<li>找到电池选项，修改如下，保存开机<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5CIMG_20210621_164601.jpg\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5CIMG_20210621_164601.jpg\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"IMG_20210621_164601\" /></li>\n</ol>\n<h2 id=\"验证\"><a class=\"markdownIt-Anchor\" href=\"#验证\"></a> 验证</h2>\n<p>一气呵成，简直完美</p>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2021/06/21/%E5%B9%B3%E5%8F%B0/%E5%AE%89%E8%A3%85mysql_5.6.33%20linux_64%E4%BD%8D/",
            "url": "http://example.com/2021/06/21/%E5%B9%B3%E5%8F%B0/%E5%AE%89%E8%A3%85mysql_5.6.33%20linux_64%E4%BD%8D/",
            "title": "安装mysql_5.6.33 linux_64位",
            "date_published": "2021-06-21T03:40:59.000Z",
            "content_html": "<h1 id=\"安装mysql_5633-linux_64位\"><a class=\"markdownIt-Anchor\" href=\"#安装mysql_5633-linux_64位\"></a> 安装mysql_5.6.33 linux_64位</h1>\n<h2 id=\"环境及软件\"><a class=\"markdownIt-Anchor\" href=\"#环境及软件\"></a> 环境及软件</h2>\n<pre><code>* Centos7\n* mysql_5.6.33 linux_64位\n* wget http://dev.mysql.com/get/Downloads/MySQL-5.6/mysql-5.6.33-linux-glibc2.5-x86_64.tar.gz\n</code></pre>\n<h2 id=\"安装流程\"><a class=\"markdownIt-Anchor\" href=\"#安装流程\"></a> 安装流程</h2>\n<h3 id=\"1-卸载老版本\"><a class=\"markdownIt-Anchor\" href=\"#1-卸载老版本\"></a> 1. 卸载老版本</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find / -name mysql</span><br><span class=\"line\">rm -rf 上边查找到的路径，多个路径用空格隔开</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">或者下边一条命令即可</span></span><br><span class=\"line\">find / -name mysql|xargs rm -r</span><br></pre></td></tr></table></figure>\n<h3 id=\"2-解压安装包到usrlocal\"><a class=\"markdownIt-Anchor\" href=\"#2-解压安装包到usrlocal\"></a> 2. 解压安装包到/usr/local</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf mysql-5.6.33-linux-glibc2.5-x86_64.tar.gz -C /usr/local</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-重命名文件夹\"><a class=\"markdownIt-Anchor\" href=\"#3-重命名文件夹\"></a> 3. 重命名文件夹</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /usr/local</span><br><span class=\"line\">mv mysql-5.6.33-linux-glibc2.5-x86_64/ mysql</span><br></pre></td></tr></table></figure>\n<h3 id=\"4-添加mysql用户组和用户名\"><a class=\"markdownIt-Anchor\" href=\"#4-添加mysql用户组和用户名\"></a> 4. 添加mysql用户组和用户名</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">groupadd mysql</span><br><span class=\"line\">useradd -r -g mysql mysql</span><br><span class=\"line\">groups mysql</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-更改文件夹权限\"><a class=\"markdownIt-Anchor\" href=\"#5-更改文件夹权限\"></a> 5. 更改文件夹权限</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd mysql/</span><br><span class=\"line\">chown -R mysql:mysql ./</span><br></pre></td></tr></table></figure>\n<h3 id=\"6-执行安装脚本\"><a class=\"markdownIt-Anchor\" href=\"#6-执行安装脚本\"></a> 6. 执行安装脚本</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./scripts/mysql_install_db --user=mysql</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">安装完执行下列语句修改权限</span></span><br><span class=\"line\">chown -R root:root ./</span><br><span class=\"line\">chown -R mysql:mysql data</span><br></pre></td></tr></table></figure>\n<h3 id=\"7-更改数据库密码\"><a class=\"markdownIt-Anchor\" href=\"#7-更改数据库密码\"></a> 7. 更改数据库密码</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">首先启动mysql</span></span><br><span class=\"line\">./support-files/mysql.server start</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">如果已经启动</span></span><br><span class=\"line\">ps aux|grep mysql</span><br><span class=\"line\">kill -9 #上边的进程号</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">或者下边一条命令即可杀掉所有MySQL进程</span></span><br><span class=\"line\">ps aux|grep mysql|awk &#x27;&#123;print $2&#125;&#x27;|xargs kill -9</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">修改密码为root</span></span><br><span class=\"line\">./bin/mysqladmin -u root -h localhost.localdomain password &#x27;root&#x27;</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">登录mysql</span></span><br><span class=\"line\">./bin/mysql -h 127.0.0.1 -u root -p root</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">修改其他用户密码</span></span><br><span class=\"line\">update mysql.user set password=password(&#x27;root&#x27;) where user=&#x27;root&#x27;;</span><br><span class=\"line\">flush privileges;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"8-添加远程登录权限\"><a class=\"markdownIt-Anchor\" href=\"#8-添加远程登录权限\"></a> 8. 添加远程登录权限</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">在mysql中输入</span></span><br><span class=\"line\">grant all privileges on *.* to root@&#x27;%&#x27; identified by &#x27;root&#x27;;</span><br><span class=\"line\">flush privileges;</span><br></pre></td></tr></table></figure>\n<h3 id=\"9-将mysql加入service系统服务\"><a class=\"markdownIt-Anchor\" href=\"#9-将mysql加入service系统服务\"></a> 9. 将MySQL加入Service系统服务</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cp support-files/mysql.server /etc/init.d/mysqld</span><br><span class=\"line\">chkconfig --add mysqld</span><br><span class=\"line\">chkconfig mysqld on</span><br><span class=\"line\">service mysqld restart</span><br><span class=\"line\">service mysqld status</span><br></pre></td></tr></table></figure>\n<h3 id=\"10-配置mycnf\"><a class=\"markdownIt-Anchor\" href=\"#10-配置mycnf\"></a> 10. 配置my.cnf</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi my.cnf</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">添加如下语句</span></span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\">lower_case_table_names=1</span><br><span class=\"line\">max_allowed_packet=100M</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">配置完成重启服务</span></span><br><span class=\"line\">service mysqld restart</span><br><span class=\"line\">service mysqld status</span><br></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://example.com/2021/05/20/%E5%B9%B3%E5%8F%B0/Centos7%E4%B8%8Byum%E5%AE%89%E8%A3%85MariaDB/",
            "url": "http://example.com/2021/05/20/%E5%B9%B3%E5%8F%B0/Centos7%E4%B8%8Byum%E5%AE%89%E8%A3%85MariaDB/",
            "title": "centos7下yum安装MariaDB",
            "date_published": "2021-05-20T03:40:59.000Z",
            "content_html": "<h1 id=\"centos7下yum安装mariadb\"><a class=\"markdownIt-Anchor\" href=\"#centos7下yum安装mariadb\"></a> centos7下yum安装MariaDB</h1>\n<p>CentOS 7下mysql下替换成MariaDB了。<br />\nMariaDB数据库管理系统是MySQL的一个分支，主要由开源社区在维护，采用GPL授权 许可 MariaDB的目的是完全兼容MySQL，包括API和命令行，使之能轻松成为MySQL的代替品。</p>\n<h2 id=\"安装\"><a class=\"markdownIt-Anchor\" href=\"#安装\"></a> 安装</h2>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install mariadb mariadb-server</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl start mariadb   #启动mariadb</span><br><span class=\"line\">systemctl enable mariadb  #设置开机自启动</span><br><span class=\"line\">systemctl stop mariadb    #停止MariaDB</span><br><span class=\"line\">systemctl restart mariadb #重启MariaDB</span><br><span class=\"line\">mysql_secure_installation #设置root密码等相关</span><br><span class=\"line\">mysql -uroot -p           #测试登录   </span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 修改密码</span></span><br><span class=\"line\">update mysql.user set password=PASSWORD(&#x27;123456&#x27;) where user=&#x27;root&#x27;;</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 更新权限</span></span><br><span class=\"line\">flush privileges; </span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 新建用户</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">create user  <span class=\"string\">&#x27;用户名&#x27;</span>@<span class=\"string\">&#x27;主机&#x27;</span> identified by <span class=\"string\">&#x27;密码&#x27;</span>   如果只允许本机访问 @<span class=\"string\">&#x27;localhost&#x27;</span>  , 或者指定一个ip  @<span class=\"string\">&#x27;192.xx.xx.xx&#x27;</span> 或者使用通配: @<span class=\"string\">&#x27;%&#x27;</span></span></span><br><span class=\"line\">create user &#x27;read_visa&#x27;@&#x27;%&#x27; identified by &#x27;123456&#x27;;</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 新用户权限</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> grant 操作类型 on 数据库.表 to 用户@<span class=\"string\">&#x27;主机&#x27;</span>   数据库,表,主机都支持通配符 grant select, insert on *.* to  <span class=\"string\">&#x27;read_visa&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> grant all on visa.* to <span class=\"string\">&#x27;read_visa&#x27;</span>@<span class=\"string\">&#x27;%&#x27;</span>; // all 表示所有权限</span></span><br><span class=\"line\">grant select on visa.* to &#x27;read_visa&#x27;@&#x27;%&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://example.com/2021/05/19/%E5%B9%B3%E5%8F%B0/Win10+noVNC/",
            "url": "http://example.com/2021/05/19/%E5%B9%B3%E5%8F%B0/Win10+noVNC/",
            "title": "Win10+noVNC",
            "date_published": "2021-05-19T03:40:59.000Z",
            "content_html": "<h1 id=\"网页实现远程桌面\"><a class=\"markdownIt-Anchor\" href=\"#网页实现远程桌面\"></a> 网页实现远程桌面</h1>\n<h2 id=\"环境\"><a class=\"markdownIt-Anchor\" href=\"#环境\"></a> 环境</h2>\n<ul>\n<li>Win10 (被访问的Server,设其IP为11.11.11.11)</li>\n</ul>\n<h2 id=\"软件\"><a class=\"markdownIt-Anchor\" href=\"#软件\"></a> 软件</h2>\n<ul>\n<li>nodejs</li>\n<li>noVnc</li>\n<li>websockify</li>\n<li>tightvnc</li>\n</ul>\n<h2 id=\"搭建流程\"><a class=\"markdownIt-Anchor\" href=\"#搭建流程\"></a> 搭建流程</h2>\n<ul>\n<li>Server安装nodejs</li>\n<li>安装ws、optimist模块（执行websockify.js文件所需）</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install ws</span><br><span class=\"line\">npm install optimist</span><br><span class=\"line\">npm install mime-types</span><br></pre></td></tr></table></figure>\n<ul>\n<li>将noVNC解压到C:\\Users\\XXX(用户名)\\node_modules\\下</li>\n<li>将websockify解压到C:\\Users\\XXX(用户名)\\node_modules\\noVNC下</li>\n<li>如图</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518103523666.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518103523666.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518103523666\" /></p>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518103547147.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518103547147.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518103547147\" /></p>\n<ul>\n<li>\n<p>将./noVNC/vnc.html复制一份，更名为index.html</p>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518105649182.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518105649182.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518105649182\" /></p>\n</li>\n<li>\n<p>Server安装tightVNC</p>\n</li>\n<li>\n<p>运行tightVNC server,任务栏找到图标<br />\n<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518103816266.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518103816266.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518103816266\" /></p>\n</li>\n<li>\n<p>单击打开，设置连接密码</p>\n</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518104024652.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518104024652.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518104024652\" /></p>\n<ul>\n<li>\n<p>这里服务默认端口5900，不用更改</p>\n</li>\n<li>\n<p>打开cmd，使用websockify.js转发9000端口的http链接到5900端口,运行以下命令</p>\n</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node C:\\Users\\SSR\\node_modules\\noVNC\\websockify-js-master\\websockify\\websockify.js --web C:\\Users\\SSR\\node_modules\\noVNC 9000 localhost:5900</span><br><span class=\"line\"><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 注意更改用户路径</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 注意更改localhost为本机IP（11.11.11.11）</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>保持cmd窗口后台运行，打开Win10防火墙设置，添加入站规则，允许TCP9000端口入站<br />\n<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518104902295.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518104902295.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518104902295\" /></li>\n<li>配置完成</li>\n</ul>\n<h2 id=\"验证效果\"><a class=\"markdownIt-Anchor\" href=\"#验证效果\"></a> 验证效果</h2>\n<ul>\n<li>打开同网段另一台电脑，打开浏览器</li>\n<li>访问ServerIP:9000，形如11.11.11.11:9000<br />\n<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518110422381.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518110422381.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518110422381\" /></li>\n<li>点击连接，输入之前设置的连接密码<br />\n<img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518110522936.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518110522936.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518110522936\" /></li>\n<li>成功连接Win10<br />\n![](E:\\SSR\\Pictures\\屏幕截图 2021-05-18 110948.png)</li>\n</ul>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2021/05/18/%E5%B9%B3%E5%8F%B0/Linux+noVNC/",
            "url": "http://example.com/2021/05/18/%E5%B9%B3%E5%8F%B0/Linux+noVNC/",
            "title": "Linux+noVNC",
            "date_published": "2021-05-18T03:40:59.000Z",
            "content_html": "<h1 id=\"linuxnovnc\"><a class=\"markdownIt-Anchor\" href=\"#linuxnovnc\"></a> Linux+noVNC</h1>\n<h2 id=\"环境及软件\"><a class=\"markdownIt-Anchor\" href=\"#环境及软件\"></a> 环境及软件</h2>\n<ul>\n<li>Centos7桌面</li>\n<li>noVNC</li>\n<li>websockify</li>\n<li>tigervnc-server</li>\n</ul>\n<h2 id=\"搭建流程\"><a class=\"markdownIt-Anchor\" href=\"#搭建流程\"></a> 搭建流程</h2>\n<ol>\n<li>安装Centos7桌面版</li>\n<li>安装noVNC\n<ul>\n<li>git clone <a href=\"https://github.com/novnc/noVNC\">https://github.com/novnc/noVNC</a></li>\n<li>git clone <a href=\"https://github.com/novnc/websockify\">https://github.com/novnc/websockify</a></li>\n<li>mv ./websockify ./noVNC/</li>\n<li>cd ./noVNC/utils/</li>\n<li>openssl req -new -x509 -days 365 -nodes -out self.pem -keyout self.pem</li>\n<li>生成证书，一直回车</li>\n<li>yum -y install python3</li>\n<li>yum -y install numpy</li>\n<li>缺啥补啥</li>\n</ul>\n</li>\n<li>安装tigervnc-server\n<ul>\n<li>yum -y install tigervnc-server</li>\n<li>建立服务</li>\n<li>vncserver :1</li>\n<li>输入连接密码，最低6位数</li>\n<li>牢记访问密码</li>\n</ul>\n</li>\n<li>启动服务</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/root/noVNC/utils/launch.sh --vnc localhost:5901</span><br></pre></td></tr></table></figure>\n<h2 id=\"测试\"><a class=\"markdownIt-Anchor\" href=\"#测试\"></a> 测试</h2>\n<ol>\n<li>打开另一台同网段电脑浏览器，Chrome/Firefox</li>\n<li>访问http://CentosIP/vnc.html</li>\n</ol>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518194210406.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518194210406.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518194210406\" /></p>\n<ol start=\"3\">\n<li>输入密码</li>\n</ol>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518194236868.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518194236868.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518194236868\" /></p>\n<ol start=\"4\">\n<li>网页连接成功</li>\n</ol>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518194333582.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210518194333582.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210518194333582\" /></p>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2021/05/03/%E5%B9%B3%E5%8F%B0/Win7%E7%B3%BB%E7%BB%9F%E5%B0%81%E8%A3%85/",
            "url": "http://example.com/2021/05/03/%E5%B9%B3%E5%8F%B0/Win7%E7%B3%BB%E7%BB%9F%E5%B0%81%E8%A3%85/",
            "title": "Win7系统封装与快速装机",
            "date_published": "2021-05-03T03:40:59.000Z",
            "content_html": "<h1 id=\"win7系统封装与快速装机\"><a class=\"markdownIt-Anchor\" href=\"#win7系统封装与快速装机\"></a> Win7系统封装与快速装机</h1>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cdos.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cdos.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"dos\" /></p>\n<h3 id=\"背景\"><a class=\"markdownIt-Anchor\" href=\"#背景\"></a> 背景</h3>\n<p>最近小编接受了一项任务，给一定数量的电脑更换系统，并且需要根据实际，在系统中安装环境和许多软件，而一台一台安装又不大现实，于是就开始了这一次艰辛的历程，从开始着手到最终成功花费了近一周的空闲时间，失败次数4次以上，而每次尝试花费的时间都在5小时左右。。。<br />\n于是特地把过程记录下来，希望能帮到有需要的人，所需要的工具放在最后。</p>\n<h3 id=\"任务目标\"><a class=\"markdownIt-Anchor\" href=\"#任务目标\"></a> 任务目标</h3>\n<p>给若干电脑装系统，并带有自定义的软件。采取的解决方法是制作自定义的封装系统。</p>\n<h3 id=\"准备工具\"><a class=\"markdownIt-Anchor\" href=\"#准备工具\"></a> 准备工具</h3>\n<ul>\n<li>\n<p>Win7镜像</p>\n</li>\n<li>\n<p>虚拟机环境</p>\n</li>\n<li>\n<p>各类软件安装包</p>\n</li>\n<li>\n<p>优化清理工具</p>\n</li>\n<li>\n<p>系统封装工具</p>\n</li>\n<li>\n<p>PE启动盘一个</p>\n</li>\n</ul>\n<h3 id=\"安装系统\"><a class=\"markdownIt-Anchor\" href=\"#安装系统\"></a> 安装系统</h3>\n<ul>\n<li>首先在VMware中安装Win7系统，安装系统步骤省略。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502203925837.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502203925837.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210502203925837\" /></p>\n<ul>\n<li>安装到这个界面时停住，建立一次快照，记得每做完几步就建立快照哦。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502204145183.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502204145183.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210502204145183\" /></p>\n<ul>\n<li>此时注意，第一个关键点，否则将失败，这里不添加用户，按下Ctrl+Shift+F3，系统重启，自动用Administrator登录。出现以下界面。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502204527028.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502204527028.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210502204527028\" /></p>\n<ul>\n<li>此时注意，第二个关键点，这里选择取消，并且以后的每次重启都选择取消。之后改改分辨率，将桌面图标调出来。</li>\n</ul>\n<h3 id=\"安装所需软件\"><a class=\"markdownIt-Anchor\" href=\"#安装所需软件\"></a> 安装所需软件</h3>\n<ul>\n<li>接下来就是一个接一个地安装软件。U1S1，安装这些软件真太费时间了。</li>\n<li>这里小编安装了一些语言环境和常用的软件，当然也可以结合需要安装不同软件。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502210406879.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502210406879.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"\" /></p>\n<h3 id=\"清理优化\"><a class=\"markdownIt-Anchor\" href=\"#清理优化\"></a> 清理优化</h3>\n<ul>\n<li>安装完所有需要的软件后，接下来将系统清理一下。</li>\n<li>使用Dism++等清理工具将系统运行不需要的功能和缓存清除，修改一些系统设置，清空回收站等，清理完后系统减小了约10G的空间。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502205849480.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502205849480.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210502205849480\" /></p>\n<h3 id=\"封装系统\"><a class=\"markdownIt-Anchor\" href=\"#封装系统\"></a> 封装系统</h3>\n<p>接下来到最关键的步骤了，这一步直接决定成功与否。</p>\n<h4 id=\"第一次封装\"><a class=\"markdownIt-Anchor\" href=\"#第一次封装\"></a> 第一次封装</h4>\n<ul>\n<li>在做好一切准备工作后，确定这就是你想要的系统时，就可以开始封装系统了。</li>\n<li>使用系统封装工具EasySysprep5对系统进行第一次封装，注意这次是在Win7系统中进行。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502210924733.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502210924733.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210502210924733\" /></p>\n<ul>\n<li>直接一键封装。封装结束后需要立即进入PE系统进行第二次封装。</li>\n</ul>\n<h4 id=\"第二次封装\"><a class=\"markdownIt-Anchor\" href=\"#第二次封装\"></a> 第二次封装</h4>\n<ul>\n<li>\n<p>关于VM中进入PE系统，这里有些经验分享给你。</p>\n</li>\n<li>\n<p>第一步，将虚拟机关机，在虚拟机设置中添加硬盘，直到这一步。</p>\n</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502211314063.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502211314063.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210502211314063\" /></p>\n<ul>\n<li>这里选择使用物理磁盘，选择PhysicalDrive1，我的情况是电脑只有一块硬盘，那么第二块就是U盘了，如果有疑惑可以打开磁盘管理查看，使用整个磁盘，添加完毕。扩展一下，这边也可以使用主机硬盘分区，就类似于共享了主机的一块分区，但是注意不能是系统分区和运行软件的分区。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503125957086.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503125957086.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210503125957086\" /></p>\n<ul>\n<li>开机选择打开电源进入固件，就是进入BIOS改变启动顺序，在BOOT选项中将第二块硬盘放到最上面，F10保存重启。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502211610879.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210502211610879.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210502211610879\" /></p>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503130535636.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503130535636.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210503130535636\" /></p>\n<ul>\n<li>进入PE后进行第二次封装，一键封装就行，如果没啥问题就成功了。封装完成后别重启，进行下一步系统备份。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503130650549.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503130650549.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210503130650549\" /></p>\n<h3 id=\"制作ghost镜像\"><a class=\"markdownIt-Anchor\" href=\"#制作ghost镜像\"></a> 制作Ghost镜像</h3>\n<ul>\n<li>使用PE系统的Ghost软件进行备份，选择Win7系统所在的盘，备份成为.gho文件。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503130903826.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503130903826.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210503130903826\" /></p>\n<ul>\n<li>经过近一小时的等待，备份40多G的系统，得到了17G大小的GHO镜像，到这里制作自定义系统就结束了。</li>\n</ul>\n<h3 id=\"测试效果\"><a class=\"markdownIt-Anchor\" href=\"#测试效果\"></a> 测试效果</h3>\n<ul>\n<li>小编在是直接在原系统上测试，进入PE使用分区工具将原系统分区和大约300M大小的引导分区格式化，再使用Ghost恢复分区，经过一小时的等待，恢复完成。</li>\n<li>这时别着急重启系统，使用DG分区工具重建还原后的分区引导，不然可能不能正常开机哦。</li>\n<li>成功启动。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503132307337.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503132307337.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210503132307337\" /></p>\n<ul>\n<li>所有环境都在，软件功能正常。</li>\n</ul>\n<p><img src=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503132750165.png\" class=\"lazyload placeholder\" data-srcset=\"C:%5CUsers%5CSSR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210503132750165.png\" srcset=\"https://img2.baidu.com/it/u=2037979560,2772131037&fm=26&fmt=auto&gp=0.jpg\" alt=\"image-20210503132750165\" /></p>\n<h3 id=\"总结\"><a class=\"markdownIt-Anchor\" href=\"#总结\"></a> 总结</h3>\n<ul>\n<li>\n<p>这件看起来很简单的事，为什么花了这么久的时间？一开始呢，就想着制作GHO镜像，然后还原就能用，但是并非如此，其实在CSDN上有很成熟的教程，但是之前并不知道“系统封装”这个关键词，信息上的缺乏真会延误战机。不过呢，在过程中了解了许多系统相关知识，还在U盘里装了个MSDOS系统，等等收获也是不少。</p>\n</li>\n<li>\n<p>最后手动@CSDN作者“小鱼儿yr”提供的详细教程，如果觉得这篇教程不够详细，可以再看看他的。</p>\n</li>\n<li>\n<p>工具链接：<a href=\"https://pan.baidu.com/s/1t_X6c1xftADwYN1diiRO1Q\">https://pan.baidu.com/s/1t_X6c1xftADwYN1diiRO1Q</a> 提取码：lc7e</p>\n</li>\n</ul>\n",
            "tags": []
        }
    ]
}